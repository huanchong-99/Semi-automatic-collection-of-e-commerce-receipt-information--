# æ”¶è´§ä¿¡æ¯è‡ªåŠ¨é‡‡é›†å·¥å…· - é¡¹ç›®å¼€å‘ä¸é—®é¢˜è§£å†³ç»¼åˆæ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°ä¸å¼€å‘è®¡åˆ’](#é¡¹ç›®æ¦‚è¿°ä¸å¼€å‘è®¡åˆ’)
2. [é‡è¯•åŠŸèƒ½å®ç°æ–¹æ¡ˆ](#é‡è¯•åŠŸèƒ½å®ç°æ–¹æ¡ˆ)
3. [éªŒè¯ç æ£€æµ‹å¼‚æ­¥ä¿®å¤æ–¹æ¡ˆ](#éªŒè¯ç æ£€æµ‹å¼‚æ­¥ä¿®å¤æ–¹æ¡ˆ)
4. [é˜¶æ®µä¸€å®ŒæˆæŠ¥å‘Š](#é˜¶æ®µä¸€å®ŒæˆæŠ¥å‘Š)

---

## é¡¹ç›®æ¦‚è¿°ä¸å¼€å‘è®¡åˆ’

### ğŸ“‹ é¡¹ç›®æ¦‚è¿°

#### é¡¹ç›®ç›®æ ‡
å¼€å‘ä¸€ä¸ªé«˜æ•ˆã€ç¨³å®šçš„ç”µå•†å¹³å°è®¢å•æ”¶è´§ä¿¡æ¯è‡ªåŠ¨é‡‡é›†å·¥å…·ï¼Œé€šè¿‡æµè§ˆå™¨è‡ªåŠ¨åŒ–æŠ€æœ¯å®ç°æ‰¹é‡è®¢å•ä¿¡æ¯çš„æ™ºèƒ½é‡‡é›†ã€å¤„ç†å’Œå¯¼å‡ºã€‚

#### æ ¸å¿ƒä»·å€¼
- **æ•ˆç‡æå‡**ï¼šå°†æ‰‹åŠ¨å¤åˆ¶ç²˜è´´çš„é‡å¤å·¥ä½œè‡ªåŠ¨åŒ–ï¼Œæé«˜å·¥ä½œæ•ˆç‡
- **å‡†ç¡®æ€§ä¿éšœ**ï¼šå‡å°‘äººå·¥æ“ä½œé”™è¯¯ï¼Œç¡®ä¿æ•°æ®é‡‡é›†çš„å‡†ç¡®æ€§
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒå¤§é‡è®¢å•çš„æ‰¹é‡è‡ªåŠ¨åŒ–å¤„ç†
- **å¤šæ ¼å¼å¯¼å‡º**ï¼šæä¾›å¤šç§æ•°æ®æ ¼å¼ï¼Œæ»¡è¶³ä¸åŒä½¿ç”¨åœºæ™¯

#### æŠ€æœ¯ç‰¹è‰²
- **å•æ–‡ä»¶æ¶æ„**ï¼šæ‰€æœ‰åŠŸèƒ½é›†æˆåœ¨ä¸€ä¸ªPythonæ–‡ä»¶ä¸­ï¼Œä¾¿äºéƒ¨ç½²å’Œç»´æŠ¤
- **æµè§ˆå™¨è°ƒè¯•æ¨¡å¼**ï¼šé€šè¿‡è¿œç¨‹è°ƒè¯•ç«¯å£è¿æ¥ï¼Œä¿æŒç”¨æˆ·ç™»å½•çŠ¶æ€
- **æ™ºèƒ½å…ƒç´ å®šä½**ï¼šæ”¯æŒè·¨iframeçš„é€’å½’å…ƒç´ å®šä½
- **å®æ—¶éªŒè¯ç æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶å¤„ç†éªŒè¯ç å¹²æ‰°
- **å¯è§†åŒ–é…ç½®**ï¼šç›´è§‚çš„GUIç•Œé¢ï¼Œæ— éœ€ç¼–ç¨‹çŸ¥è¯†

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

#### æ•´ä½“æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·ç•Œé¢å±‚ (GUI Layer)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tkinterä¸»çª—å£  â”‚  é…ç½®å¯¹è¯æ¡†  â”‚  è¿›åº¦æ˜¾ç¤º  â”‚  çŠ¶æ€ç›‘æ§      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¸šåŠ¡é€»è¾‘å±‚ (Business Layer)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å…ƒç´ é‡‡é›†ç®¡ç†  â”‚  æ“ä½œåºåˆ—æ§åˆ¶  â”‚  æ•°æ®å¤„ç†  â”‚  å¯¼å‡ºç®¡ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æœåŠ¡å±‚ (Service Layer)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æµè§ˆå™¨æ§åˆ¶  â”‚  å…ƒç´ å®šä½  â”‚  è‡ªåŠ¨åŒ–æ“ä½œ  â”‚  éªŒè¯ç æ£€æµ‹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åŸºç¡€è®¾æ–½å±‚ (Infrastructure)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Selenium WebDriver  â”‚  OpenCV  â”‚  PyAutoGUI  â”‚  æ–‡ä»¶ç³»ç»Ÿ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | ç”¨é€”è¯´æ˜ |
|----------|----------|----------|
| **Python** | 3.8+ | ä¸»è¦å¼€å‘è¯­è¨€ |
| **Tkinter** | 8.6+ | GUIç•Œé¢æ¡†æ¶ |
| **Selenium** | 4.0+ | æµè§ˆå™¨è‡ªåŠ¨åŒ–æ§åˆ¶ |
| **OpenCV** | 4.5+ | å›¾åƒå¤„ç†å’ŒéªŒè¯ç æ£€æµ‹ |
| **PyAutoGUI** | 0.9+ | é¼ æ ‡é”®ç›˜è‡ªåŠ¨åŒ–æ“ä½œ |
| **Pandas** | 1.3+ | æ•°æ®å¤„ç†å’ŒExcelå¯¼å‡º |
| **python-docx** | 0.8+ | Wordæ–‡æ¡£ç”Ÿæˆ |
| **pywin32** | 227+ | Windowsç³»ç»ŸAPIè°ƒç”¨ |
| **Pillow** | 8.0+ | å›¾åƒå¤„ç†æ”¯æŒ |
| **pyperclip** | 1.8+ | å‰ªè´´æ¿æ“ä½œ |

### ğŸ”§ æ ¸å¿ƒæ¨¡å—è®¾è®¡

#### 1. æµè§ˆå™¨æ§åˆ¶æ¨¡å—

**åŠŸèƒ½èŒè´£**
- Edgeæµè§ˆå™¨å¯åŠ¨å’Œè°ƒè¯•ç«¯å£è¿æ¥
- WebDriverå®ä¾‹ç®¡ç†å’Œç”Ÿå‘½å‘¨æœŸæ§åˆ¶
- æµè§ˆå™¨çŠ¶æ€ç›‘æ§å’Œå¼‚å¸¸æ¢å¤
- ç”¨æˆ·æ•°æ®ç›®å½•ç®¡ç†

**æŠ€æœ¯éš¾ç‚¹**
- **è°ƒè¯•ç«¯å£ç®¡ç†**ï¼šç¡®ä¿ç«¯å£ä¸å†²çªï¼Œæ”¯æŒå¤šå®ä¾‹è¿è¡Œ
- **è¿æ¥ç¨³å®šæ€§**ï¼šå¤„ç†ç½‘ç»œä¸­æ–­ã€æµè§ˆå™¨å´©æºƒç­‰å¼‚å¸¸æƒ…å†µ
- **ç”¨æˆ·æ•°æ®ä¿æŒ**ï¼šç»´æŠ¤ç™»å½•çŠ¶æ€å’Œä¸ªäººè®¾ç½®

#### 2. å…ƒç´ é‡‡é›†æ¨¡å—

**åŠŸèƒ½èŒè´£**
- é¼ æ ‡æ‚¬åœå…ƒç´ çš„XPathè‡ªåŠ¨ç”Ÿæˆ
- è·¨iframeçš„é€’å½’å…ƒç´ å®šä½
- å…ƒç´ æ“ä½œç±»å‹é…ç½®ï¼ˆç‚¹å‡»ã€è·å–æ–‡æœ¬ã€å‰ªè´´æ¿ï¼‰
- å…ƒç´ é¢„è§ˆå’ŒéªŒè¯åŠŸèƒ½

**æŠ€æœ¯éš¾ç‚¹**
- **XPathç”Ÿæˆç­–ç•¥**ï¼šç”Ÿæˆç¨³å®šã€å”¯ä¸€çš„å…ƒç´ å®šä½ç¬¦
- **iframeå¤„ç†**ï¼šå¤„ç†å¤æ‚çš„åµŒå¥—æ¡†æ¶ç»“æ„
- **å…ƒç´ å˜åŒ–é€‚åº”**ï¼šåº”å¯¹é¡µé¢åŠ¨æ€åŠ è½½å’Œç»“æ„å˜åŒ–

#### 3. è‡ªåŠ¨åŒ–æ“ä½œæ¨¡å—

**åŠŸèƒ½èŒè´£**
- æ“ä½œåºåˆ—çš„é…ç½®å’Œæ‰§è¡Œ
- WASDå¾®è°ƒåŠŸèƒ½å®ç°
- æ™ºèƒ½æ»šåŠ¨è·ç¦»è®¡ç®—
- æ‰¹é‡æ“ä½œè¿›åº¦æ§åˆ¶

**æŠ€æœ¯éš¾ç‚¹**
- **æ»šåŠ¨ç®—æ³•ä¼˜åŒ–**ï¼šå‡†ç¡®è®¡ç®—ä¸åŒé¡µé¢å¸ƒå±€ä¸‹çš„æ»šåŠ¨è·ç¦»
- **æ“ä½œæ—¶åºæ§åˆ¶**ï¼šå¤„ç†é¡µé¢åŠ è½½å»¶è¿Ÿå’ŒåŠ¨ç”»æ•ˆæœ
- **å¼‚å¸¸æ¢å¤æœºåˆ¶**ï¼šæ“ä½œå¤±è´¥æ—¶çš„é‡è¯•å’Œæ¢å¤ç­–ç•¥

#### 4. éªŒè¯ç æ£€æµ‹æ¨¡å—

**åŠŸèƒ½èŒè´£**
- å®æ—¶é¡µé¢æˆªå›¾å’ŒéªŒè¯ç æ£€æµ‹
- æ¨¡æ¿åŒ¹é…ç®—æ³•å®ç°
- é®ç½©å±‚å˜åŒ–ç›‘æ§
- æ£€æµ‹ç»“æœçš„ç”¨æˆ·é€šçŸ¥

**æŠ€æœ¯éš¾ç‚¹**
- **æ£€æµ‹å‡†ç¡®æ€§**ï¼šå‡å°‘è¯¯æŠ¥å’Œæ¼æŠ¥
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå®æ—¶æ£€æµ‹ä¸å½±å“ä¸»è¦åŠŸèƒ½
- **é€‚åº”æ€§**ï¼šæ”¯æŒä¸åŒç±»å‹çš„éªŒè¯ç 

#### 5. æ•°æ®å¤„ç†æ¨¡å—

**åŠŸèƒ½èŒè´£**
- é‡‡é›†æ•°æ®çš„ç»“æ„åŒ–å¤„ç†
- é‡å¤æ•°æ®çš„æ™ºèƒ½å»é‡
- å¤šæ ¼å¼æ•°æ®å¯¼å‡º
- æ•°æ®éªŒè¯å’Œæ¸…æ´—

### ğŸ¨ ç”¨æˆ·äº¤äº’è®¾è®¡

#### GUIç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸»çª—å£æ ‡é¢˜æ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æµè§ˆå™¨çŠ¶æ€: [â—å·²è¿æ¥]     æ¨¡å¼: [â—‹æ­£å¸¸æ¨¡å¼ â—é‡‡é›†æ¨¡å¼]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æ‰“å¼€æµè§ˆå™¨] [é‡æ–°è¿æ¥] [é€‰æ‹©ç›®æ ‡çª—å£] [çª—å£ç½®é¡¶: â˜‘]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å¼€å§‹] [æš‚åœ] [ç»§ç»­] [ç»ˆæ­¢] [é…ç½®æ“ä½œ] [éªŒè¯ç ç®¡ç†]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      è¿›åº¦æ˜¾ç¤ºåŒºåŸŸ                           â”‚
â”‚  å½“å‰è¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 85% (17/20)           â”‚
â”‚  å½“å‰æ“ä½œ: æ­£åœ¨ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®...                       â”‚
â”‚  éªŒè¯ç çŠ¶æ€: æœªæ£€æµ‹åˆ°éªŒè¯ç                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      æ“ä½œæ—¥å¿—åŒºåŸŸ                           â”‚
â”‚  [14:30:25] æˆåŠŸé‡‡é›†å…ƒç´ : è®¢å•å·                           â”‚
â”‚  [14:30:26] æˆåŠŸé‡‡é›†å…ƒç´ : æ”¶è´§äººå§“å                       â”‚
â”‚  [14:30:27] æ£€æµ‹åˆ°éªŒè¯ç ï¼Œæ“ä½œå·²æš‚åœ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å¯¼å‡ºExcel] [å¯¼å‡ºWord] [å¯¼å‡ºJSON] [æ¸…ç©ºæ•°æ®] [æŸ¥çœ‹æ—¥å¿—]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š æ•°æ®æµè®¾è®¡

#### é…ç½®æ–‡ä»¶ç»“æ„

**å…ƒç´ é…ç½® (é‡‡é›†åˆ°çš„å…ƒç´ .json)**
```json
{
  "elements": [
    {
      "name": "è®¢å•å·",
      "xpath": "//span[@class='order-id']",
      "action": "get_text",
      "order": 1,
      "loop_mode": "always",
      "description": "è·å–è®¢å•ç¼–å·"
    }
  ],
  "sequence_config": {
    "total_orders_element": "å¾…å‘è´§æ•°é‡",
    "scroll_distance": 500,
    "wait_time": 1.0
  }
}
```

**åç§»é‡é…ç½® (offset_config.json)**
```json
{
  "offsets": {
    "è®¢å•å·": {"x": 0, "y": 0},
    "æ”¶è´§äºº": {"x": 5, "y": -2},
    "æ”¶è´§åœ°å€": {"x": 0, "y": 3}
  }
}
```

**éªŒè¯ç é…ç½® (captcha_config.json)**
```json
{
  "detection_enabled": true,
  "template_path": "æ¨¡æ¿.jpg",
  "detection_area": {
    "x": 0, "y": 0, "width": 1920, "height": 1080
  },
  "threshold": 0.8,
  "check_interval": 1.0
}
```

### ğŸ” å…³é”®ç®—æ³•å®ç°

#### 1. æ™ºèƒ½XPathç”Ÿæˆç®—æ³•

```python
def generate_robust_xpath(element):
    """
    ç”Ÿæˆç¨³å®šçš„XPathè¡¨è¾¾å¼
    ä¼˜å…ˆçº§ï¼šid > classç»„åˆ > å±æ€§ç»„åˆ > å±‚çº§å…³ç³» > æ–‡æœ¬å†…å®¹
    """
    # 1. æ£€æŸ¥idå±æ€§
    if element.get_attribute('id'):
        return f"//*[@id='{element.get_attribute('id')}']"
    
    # 2. æ£€æŸ¥classç»„åˆ
    classes = element.get_attribute('class')
    if classes and len(classes.split()) > 1:
        class_xpath = ' and '.join([f"contains(@class, '{cls}')" for cls in classes.split()])
        return f"//*[{class_xpath}]"
    
    # 3. æ£€æŸ¥å…¶ä»–å±æ€§
    for attr in ['data-id', 'name', 'value']:
        if element.get_attribute(attr):
            return f"//*[@{attr}='{element.get_attribute(attr)}']"
    
    # 4. ä½¿ç”¨å±‚çº§å…³ç³»
    return generate_hierarchical_xpath(element)
```

#### 2. æ™ºèƒ½æ»šåŠ¨è·ç¦»è®¡ç®—

```python
def calculate_scroll_distance(from_element, to_element):
    """
    åŸºäºå…ƒç´ ä½ç½®è®¡ç®—æœ€ä¼˜æ»šåŠ¨è·ç¦»
    """
    # è·å–å…ƒç´ ä½ç½®
    from_rect = from_element.rect
    to_rect = to_element.rect
    
    # è®¡ç®—å‚ç›´è·ç¦»
    vertical_distance = to_rect['y'] - from_rect['y']
    
    # è€ƒè™‘è§†çª—é«˜åº¦
    viewport_height = driver.execute_script("return window.innerHeight")
    
    # æ™ºèƒ½è°ƒæ•´æ»šåŠ¨è·ç¦»
    if abs(vertical_distance) > viewport_height * 0.8:
        # å¤§è·ç¦»ï¼šåˆ†æ®µæ»šåŠ¨
        return sign(vertical_distance) * viewport_height * 0.7
    else:
        # å°è·ç¦»ï¼šç²¾ç¡®æ»šåŠ¨
        return vertical_distance * 0.9
```

#### 3. éªŒè¯ç æ£€æµ‹ç®—æ³•

```python
def detect_captcha_by_template(screenshot, template):
    """
    åŸºäºæ¨¡æ¿åŒ¹é…çš„éªŒè¯ç æ£€æµ‹
    """
    # è½¬æ¢ä¸ºç°åº¦å›¾
    gray_screenshot = cv2.cvtColor(screenshot, cv2.COLOR_BGR2GRAY)
    gray_template = cv2.cvtColor(template, cv2.COLOR_BGR2GRAY)
    
    # å¤šå°ºåº¦æ¨¡æ¿åŒ¹é…
    scales = [0.8, 0.9, 1.0, 1.1, 1.2]
    max_confidence = 0
    
    for scale in scales:
        # ç¼©æ”¾æ¨¡æ¿
        scaled_template = cv2.resize(gray_template, None, fx=scale, fy=scale)
        
        # æ¨¡æ¿åŒ¹é…
        result = cv2.matchTemplate(gray_screenshot, scaled_template, cv2.TM_CCOEFF_NORMED)
        _, confidence, _, _ = cv2.minMaxLoc(result)
        
        max_confidence = max(max_confidence, confidence)
    
    return max_confidence > 0.8
```

### ğŸ›¡ï¸ é”™è¯¯å¤„ç†ç­–ç•¥

#### å¼‚å¸¸åˆ†ç±»å’Œå¤„ç†

| å¼‚å¸¸ç±»å‹ | å¤„ç†ç­–ç•¥ | æ¢å¤æœºåˆ¶ |
|----------|----------|----------|
| **ç½‘ç»œè¿æ¥å¼‚å¸¸** | é‡è¯•è¿æ¥ï¼Œè¶…æ—¶æé†’ | è‡ªåŠ¨é‡è¿ï¼Œæ‰‹åŠ¨é‡å¯ |
| **å…ƒç´ å®šä½å¤±è´¥** | è®°å½•é”™è¯¯ï¼Œè·³è¿‡å…ƒç´  | é‡æ–°é‡‡é›†ï¼Œæ›´æ–°XPath |
| **æµè§ˆå™¨å´©æºƒ** | æ£€æµ‹è¿›ç¨‹ï¼Œé‡å¯æµè§ˆå™¨ | ä¿å­˜çŠ¶æ€ï¼Œæ¢å¤ä¼šè¯ |
| **éªŒè¯ç å¹²æ‰°** | è‡ªåŠ¨æš‚åœï¼Œç”¨æˆ·å¤„ç† | æ‰‹åŠ¨ç»§ç»­ï¼ŒçŠ¶æ€æ¢å¤ |
| **æƒé™ä¸è¶³** | æç¤ºç®¡ç†å‘˜è¿è¡Œ | é‡æ–°å¯åŠ¨ï¼Œæƒé™æ£€æŸ¥ |
| **ä¾èµ–ç¼ºå¤±** | è‡ªåŠ¨å®‰è£…ï¼Œé‡å¯ç¨‹åº | æ‰‹åŠ¨å®‰è£…ï¼Œç¯å¢ƒæ£€æŸ¥ |

### âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### 1. å†…å­˜ç®¡ç†
- **å¯¹è±¡æ± æ¨¡å¼**ï¼šå¤ç”¨WebDriverå®ä¾‹
- **æ•°æ®åˆ†é¡µ**ï¼šå¤§é‡æ•°æ®åˆ†æ‰¹å¤„ç†
- **ç¼“å­˜ç­–ç•¥**ï¼šç¼“å­˜å¸¸ç”¨å…ƒç´ å®šä½
- **åƒåœ¾å›æ”¶**ï¼šåŠæ—¶é‡Šæ”¾æ— ç”¨å¯¹è±¡

#### 2. æ‰§è¡Œæ•ˆç‡
- **å¹¶å‘å¤„ç†**ï¼šéªŒè¯ç æ£€æµ‹å¼‚æ­¥æ‰§è¡Œ
- **æ™ºèƒ½ç­‰å¾…**ï¼šåŠ¨æ€è°ƒæ•´ç­‰å¾…æ—¶é—´
- **æ‰¹é‡æ“ä½œ**ï¼šå‡å°‘å•æ¬¡æ“ä½œå¼€é”€
- **é¢„åŠ è½½æœºåˆ¶**ï¼šæå‰åŠ è½½ä¸‹ä¸€é¡µé¢

#### 3. ç”¨æˆ·ä½“éªŒ
- **è¿›åº¦åé¦ˆ**ï¼šå®æ—¶æ˜¾ç¤ºæ‰§è¡Œè¿›åº¦
- **å“åº”å¼ç•Œé¢**ï¼šé¿å…ç•Œé¢å†»ç»“
- **æ“ä½œæç¤º**ï¼šæ¸…æ™°çš„çŠ¶æ€ä¿¡æ¯
- **å¿«æ·æ“ä½œ**ï¼šé”®ç›˜å¿«æ·é”®æ”¯æŒ

### ğŸš€ éƒ¨ç½²å’Œç»´æŠ¤

#### éƒ¨ç½²æ–¹æ¡ˆ

**æ–¹æ¡ˆä¸€ï¼šæºç éƒ¨ç½²**
```bash
# 1. ç¯å¢ƒå‡†å¤‡
python -m venv venv
venv\Scripts\activate

# 2. ä¾èµ–å®‰è£…
pip install -r requirements.txt

# 3. è¿è¡Œç¨‹åº
python main.py
```

**æ–¹æ¡ˆäºŒï¼šæ‰“åŒ…éƒ¨ç½²**
```bash
# ä½¿ç”¨PyInstalleræ‰“åŒ…
pyinstaller --onefile --windowed --icon=icon.ico main.py
```

#### ç»´æŠ¤è®¡åˆ’

**æ—¥å¸¸ç»´æŠ¤**
- **æ—¥å¿—ç›‘æ§**ï¼šå®šæœŸæ£€æŸ¥é”™è¯¯æ—¥å¿—
- **æ€§èƒ½ç›‘æ§**ï¼šç›‘æ§å†…å­˜å’ŒCPUä½¿ç”¨
- **ç”¨æˆ·åé¦ˆ**ï¼šæ”¶é›†å’Œå¤„ç†ç”¨æˆ·é—®é¢˜
- **ä¾èµ–æ›´æ–°**ï¼šå®šæœŸæ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬

---

## é‡è¯•åŠŸèƒ½å®ç°æ–¹æ¡ˆ

### âš ï¸ å…³é”®å®ç°è¦ç‚¹ï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆï¼‰

#### ğŸ”´ é”™è¯¯ç‚¹1ï¼šåæ ‡ç¼“å­˜ä½¿ç”¨é€»è¾‘
- **æ­£å¸¸æ¨¡å¼**ï¼šç»å¯¹ä¸ä¼šä½¿ç”¨ç¼“å­˜åæ ‡è¿›è¡Œå…ƒç´ æŸ¥æ‰¾ï¼Œä½†ç‚¹å‡»æˆåŠŸåå¿…é¡»å°†åæ ‡ä¿å­˜åˆ°ç¼“å­˜
- **é‡è¯•æ¨¡å¼**ï¼šä¼˜å…ˆä½¿ç”¨æ­£å¸¸çš„å…ƒç´ æŸ¥æ‰¾æ–¹å¼ï¼ˆXPathã€æ–‡æœ¬ã€CSSç­‰ï¼‰ï¼Œåªæœ‰å½“æ‰€æœ‰å…ƒç´ æŸ¥æ‰¾ç­–ç•¥éƒ½å¤±è´¥æ—¶ï¼Œæ‰ä½¿ç”¨ç¼“å­˜åæ ‡ä½œä¸ºæœ€åçš„å¤‡é€‰æ–¹æ¡ˆ
- **ç¼“å­˜ç”Ÿå‘½å‘¨æœŸ**ï¼šé‡è¯•æ¨¡å¼ç»“æŸåç«‹å³åœæ­¢è°ƒç”¨ç¼“å­˜åæ ‡åŠŸèƒ½
- **é‡è¦å¼ºè°ƒ**ï¼šé‡è¯•æ¨¡å¼ä¸æ˜¯å¿…å®šä½¿ç”¨ç¼“å­˜åæ ‡ï¼Œè€Œæ˜¯å’Œæ­£å¸¸æ¨¡å¼ä¸€æ ·å…ˆå°è¯•æŸ¥æ‰¾å…ƒç´ ï¼ŒæŸ¥æ‰¾ä¸åˆ°æ‰ä½¿ç”¨ç¼“å­˜åæ ‡

#### ğŸ”´ é”™è¯¯ç‚¹2ï¼šXPathåŠ¨æ€å˜åŒ–ä¸è‡ªåŠ¨å­¦ä¹ 
- **ç°æœ‰æœºåˆ¶**ï¼šåœ¨è´Ÿè´£ä¸‹æ»‘çš„æ¨¡å—ä¸­ï¼Œç³»ç»Ÿå·²ç»å®ç°äº†å¯¹ä¸åŒè®¢å•å‚ç…§ç‚¹çš„è‡ªåŠ¨å­¦ä¹ æœºåˆ¶
- **å­¦ä¹ è¦æ±‚**ï¼šå¿…é¡»å…ˆæ·±å…¥å­¦ä¹ ç°æœ‰çš„XPathè‡ªåŠ¨å­¦ä¹ å®ç°ï¼Œç†è§£å…¶å·¥ä½œåŸç†å’Œæ•°æ®ç»“æ„
- **é‡æ–°åº”ç”¨**ï¼šå°†å­¦ä¹ åˆ°çš„è‡ªåŠ¨å­¦ä¹ æœºåˆ¶åº”ç”¨åˆ°é‡è¯•åŠŸèƒ½ä¸­ï¼Œä½¿ç³»ç»Ÿèƒ½å¤Ÿé€‚åº”XPathçš„åŠ¨æ€å˜åŒ–
- **åŠ¨æ€é€‚åº”**ï¼šç¡®ä¿é‡è¯•åŠŸèƒ½èƒ½å¤Ÿå­¦ä¹ å’Œè®°å¿†æˆåŠŸçš„XPathæ¨¡å¼ï¼Œæé«˜åç»­é‡è¯•çš„æˆåŠŸç‡

### ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†æ”¶è´§ä¿¡æ¯é‡‡é›†å·¥å…·ä¸­éªŒè¯ç æ£€æµ‹åçš„é‡è¯•åŠŸèƒ½å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µçš„å®ç°è®¡åˆ’å’Œå¯¹åº”çš„è¾¾æˆåº¦è¯„ä¼°æ ‡å‡†ã€‚

### ğŸ¯ æ€»ä½“ç›®æ ‡

å½“éªŒè¯ç æ£€æµ‹æ¨¡å—å‘ç°éªŒè¯ç æ¶ˆå¤±åï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨é‡æ–°æ‰§è¡Œå½“å‰è®¢å•çš„æ•°æ®é‡‡é›†æ“ä½œï¼Œç¡®ä¿æ•°æ®é‡‡é›†çš„è¿ç»­æ€§å’Œå®Œæ•´æ€§ã€‚

### é˜¶æ®µä¸€ï¼šåŸºç¡€é‡è¯•æœºåˆ¶

#### ğŸ”§ å®ç°æ–¹æ¡ˆ

**1.1 ä¿®æ”¹ `captcha_detector.py`**

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\captcha_detector.py`

**ä¿®æ”¹ç›®æ ‡ï¼š** `_on_captcha_disappeared()` æ–¹æ³•ï¼ˆçº¦ç¬¬560-572è¡Œï¼‰

**å…·ä½“å®ç°ï¼š**
```python
def _on_captcha_disappeared(self):
    """éªŒè¯ç æ¶ˆå¤±æ—¶çš„å¤„ç†"""
    try:
        # æ¸…é™¤å¼ºåˆ¶åœæ­¢æ ‡å¿—
        if hasattr(self, 'force_stop_flag'):
            self.force_stop_flag = False
        
        self._log_info("éªŒè¯ç å·²æ¶ˆå¤±", "green")
        self._update_captcha_status_display()
        
        # è®¾ç½®é‡è¯•æ ‡å¿— - æ–°å¢åŠŸèƒ½
        self.retry_current_order = True
        self.root.after(0, self._trigger_order_retry)
        
        # å¦‚æœä¹‹å‰å› éªŒè¯ç æš‚åœï¼Œç°åœ¨å¯ä»¥å‡†å¤‡é‡æ–°æ‰§è¡Œå½“å‰è®¢å•
        if self.is_paused and hasattr(self, 'current_order_index'):
            self._log_info("éªŒè¯ç å·²å¤„ç†ï¼Œå‡†å¤‡é‡è¯•å½“å‰è®¢å•", "green")
        
    except Exception as e:
        self._log_info(f"å¤„ç†éªŒè¯ç æ¶ˆå¤±äº‹ä»¶å‡ºé”™: {e}", "error")

def _trigger_order_retry(self):
    """è§¦å‘è®¢å•é‡è¯• - æ–°å¢æ–¹æ³•"""
    try:
        if hasattr(self, 'retry_current_order') and self.retry_current_order:
            self._log_info("è§¦å‘å½“å‰è®¢å•é‡è¯•æœºåˆ¶", "blue")
            # é‡è¯•æ ‡å¿—å°†åœ¨ data_processor.py ä¸­è¢«æ£€æŸ¥å’Œå¤„ç†
    except Exception as e:
        self._log_info(f"è§¦å‘è®¢å•é‡è¯•å¤±è´¥: {e}", "error")
```

**1.2 ä¿®æ”¹ `data_processor.py`**

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\data_processor.py`

**ä¿®æ”¹ç›®æ ‡ï¼š** `run_actions_loop()` æ–¹æ³•ï¼ˆçº¦ç¬¬80-200è¡Œï¼‰

**å…·ä½“å®ç°ï¼š**
```python
# åœ¨ for i in range(1, num_items+1): å¾ªç¯å¼€å§‹å¤„æ·»åŠ é‡è¯•æ£€æŸ¥
for i in range(1, num_items+1):
    if not self.is_running:
        break
    
    # æ£€æŸ¥é‡è¯•æ ‡å¿— - æ–°å¢åŠŸèƒ½
    if hasattr(self, 'retry_current_order') and self.retry_current_order:
        self.retry_current_order = False
        # é‡ç½®ç›¸å…³çŠ¶æ€
        consecutive_same_order = 0
        self._log_info(f"[é‡è¯•] é‡æ–°å¤„ç†ç¬¬ {i}/{num_items} ä¸ªè®¢å•", "orange")
        # ä¸é€’å¢ iï¼Œé‡æ–°å¤„ç†å½“å‰è®¢å•
        i -= 1
        if i < 1:
            i = 1
    
    self._log_info(f"[å¾ªç¯] æ­£åœ¨å¤„ç†ç¬¬ {i}/{num_items} ä¸ªè®¢å•", "blue")
    order_data = {}
    
    # ... å…¶ä½™ä»£ç ä¿æŒä¸å˜
```

#### ğŸ“Š è¾¾æˆåº¦è¯„ä¼°æ ‡å‡†

**âœ… å®Œå…¨è¾¾æˆ (100%)**
- [x] `_on_captcha_disappeared()` æ–¹æ³•æˆåŠŸè®¾ç½® `retry_current_order = True`
- [x] `_trigger_order_retry()` æ–¹æ³•æ­£ç¡®å®ç°å¹¶å¯è°ƒç”¨
- [x] `run_actions_loop()` ä¸­æ­£ç¡®æ£€æŸ¥é‡è¯•æ ‡å¿—
- [x] é‡è¯•æ—¶æ­£ç¡®é‡ç½® `consecutive_same_order` è®¡æ•°å™¨
- [x] é‡è¯•æ—¥å¿—æ­£ç¡®è¾“å‡ºï¼ŒåŒ…å«"[é‡è¯•]"æ ‡è¯†
- [x] éªŒè¯ç æ¶ˆå¤±åèƒ½è‡ªåŠ¨é‡æ–°å¤„ç†å½“å‰è®¢å•
- [x] ä¸å½±å“æ­£å¸¸çš„è®¢å•å¤„ç†æµç¨‹

### é˜¶æ®µäºŒï¼šåæ ‡ç¼“å­˜ä¼˜åŒ–

#### âš ï¸ é‡è¦å®ç°è¦ç‚¹ï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆï¼‰

**1. åæ ‡ç¼“å­˜ä½¿ç”¨é€»è¾‘**
- **æ­£å¸¸æ¨¡å¼**ï¼šä¸ä½¿ç”¨ç¼“å­˜åæ ‡è¿›è¡Œå…ƒç´ æŸ¥æ‰¾ï¼Œä½†æˆåŠŸç‚¹å‡»åä¼šå°†åæ ‡ä¿å­˜åˆ°ç¼“å­˜
- **é‡è¯•æ¨¡å¼**ï¼šä¼˜å…ˆä½¿ç”¨æ­£å¸¸çš„å…ƒç´ æŸ¥æ‰¾æ–¹å¼ï¼Œåªæœ‰å½“å…ƒç´ æŸ¥æ‰¾å¤±è´¥æ—¶æ‰ä½¿ç”¨ç¼“å­˜åæ ‡
- **ç¼“å­˜ç”Ÿå‘½å‘¨æœŸ**ï¼šé‡è¯•æ¨¡å¼ç»“æŸåç«‹å³åœæ­¢ä½¿ç”¨ç¼“å­˜åæ ‡
- **ç¼“å­˜ç­–ç•¥**ï¼šé‡è¯•æ¨¡å¼ä¸æ˜¯å¿…å®šä½¿ç”¨ç¼“å­˜åæ ‡ï¼Œè€Œæ˜¯ä½œä¸ºæŸ¥æ‰¾å¤±è´¥çš„å¤‡é€‰æ–¹æ¡ˆ

**2. XPathåŠ¨æ€å­¦ä¹ æœºåˆ¶**
- **å­¦ä¹ ç°æœ‰æœºåˆ¶**ï¼šåœ¨è´Ÿè´£ä¸‹æ»‘çš„æ¨¡å—ä¸­ï¼Œç³»ç»Ÿå·²ç»å®ç°äº†å¯¹ä¸åŒè®¢å•å‚ç…§ç‚¹çš„è‡ªåŠ¨å­¦ä¹ 
- **é‡æ–°åº”ç”¨**ï¼šéœ€è¦å­¦ä¹ ç°æœ‰çš„è‡ªåŠ¨å­¦ä¹ æœºåˆ¶ï¼Œç„¶åå°†å…¶åº”ç”¨åˆ°é‡è¯•åŠŸèƒ½ä¸­
- **åŠ¨æ€é€‚åº”**ï¼šç³»ç»Ÿåº”èƒ½å¤Ÿå­¦ä¹ å’Œé€‚åº”XPathçš„åŠ¨æ€å˜åŒ–

#### ğŸ”§ å®ç°æ–¹æ¡ˆ

**2.1 åˆ›å»ºåæ ‡ç¼“å­˜ç³»ç»Ÿ**

**æ–°å¢æ–‡ä»¶ï¼š** `coordinate_cache.json`

**æ–‡ä»¶ç»“æ„ï¼š**
```json
{
  "cache_version": "1.0",
  "last_updated": "2024-01-01T12:00:00",
  "coordinates": {
    "è®¢å•ç¼–å·": {
      "screen_x": 500,
      "screen_y": 300,
      "element_offset_x": 0,
      "element_offset_y": 0,
      "success_count": 5,
      "last_success": "2024-01-01T12:00:00"
    }
  }
}
```

**2.2 ä¿®æ”¹ `data_processor.py` - åæ ‡ä¿å­˜**

**ä¿®æ”¹ç›®æ ‡ï¼š** `_execute_operation()` æ–¹æ³•ï¼ˆçº¦ç¬¬200-500è¡Œï¼‰

**å…·ä½“å®ç°ï¼š**
```python
# åœ¨æˆåŠŸç‚¹å‡»åæ·»åŠ åæ ‡ç¼“å­˜é€»è¾‘
def _execute_operation(self, operation):
    # ... ç°æœ‰ä»£ç  ...
    
    # åœ¨æˆåŠŸç‚¹å‡»åä¿å­˜åæ ‡
    if action in ["click", "clickAndGetClipboard"]:
        # ... ç°æœ‰ç‚¹å‡»é€»è¾‘ ...
        
        # ç‚¹å‡»æˆåŠŸåä¿å­˜åæ ‡ - æ–°å¢åŠŸèƒ½
        self._save_successful_coordinates(name, screen_x, screen_y, element_offset_x, element_offset_y)
        
    # ... å…¶ä½™ä»£ç ä¿æŒä¸å˜

def _save_successful_coordinates(self, element_name, screen_x, screen_y, offset_x, offset_y):
    """ä¿å­˜æˆåŠŸçš„ç‚¹å‡»åæ ‡ - æ–°å¢æ–¹æ³•"""
    try:
        cache_file = "coordinate_cache.json"
        cache_data = {}
        
        # è¯»å–ç°æœ‰ç¼“å­˜
        if os.path.exists(cache_file):
            with open(cache_file, 'r', encoding='utf-8') as f:
                cache_data = json.load(f)
        
        # åˆå§‹åŒ–ç¼“å­˜ç»“æ„
        if 'coordinates' not in cache_data:
            cache_data['coordinates'] = {}
        
        # æ›´æ–°åæ ‡ä¿¡æ¯
        if element_name not in cache_data['coordinates']:
            cache_data['coordinates'][element_name] = {'success_count': 0}
        
        coord_info = cache_data['coordinates'][element_name]
        coord_info.update({
            'screen_x': screen_x,
            'screen_y': screen_y,
            'element_offset_x': offset_x,
            'element_offset_y': offset_y,
            'success_count': coord_info.get('success_count', 0) + 1,
            'last_success': datetime.now().isoformat()
        })
        
        cache_data['cache_version'] = '1.0'
        cache_data['last_updated'] = datetime.now().isoformat()
        
        # ä¿å­˜ç¼“å­˜
        with open(cache_file, 'w', encoding='utf-8') as f:
            json.dump(cache_data, f, ensure_ascii=False, indent=2)
        
        self._log_info(f"[ç¼“å­˜] å·²ä¿å­˜å…ƒç´ '{element_name}'çš„æˆåŠŸåæ ‡", "blue")
        
    except Exception as e:
        self._log_info(f"ä¿å­˜åæ ‡ç¼“å­˜å¤±è´¥: {e}", "error")
```

### é˜¶æ®µä¸‰ï¼šé…ç½®åŒ–å¢å¼º

#### ğŸ”§ å®ç°æ–¹æ¡ˆ

**3.1 åˆ›å»ºé‡è¯•é…ç½®æ–‡ä»¶**

**æ–°å¢æ–‡ä»¶ï¼š** `retry_config.json`

**æ–‡ä»¶ç»“æ„ï¼š**
```json
{
  "retry_settings": {
    "max_retry_attempts": 3,
    "retry_delay_seconds": 2.0,
    "use_coordinate_cache": true,
    "cache_expiry_hours": 24,
    "retry_strategies": [
      "cached_coordinates",
      "smart_element_search",
      "fallback_xpath"
    ],
    "enable_retry_logging": true,
    "retry_timeout_seconds": 30
  },
  "coordinate_validation": {
    "enable_validation": true,
    "max_coordinate_age_minutes": 60,
    "min_success_count": 2,
    "screen_bounds_check": true
  },
  "fallback_options": {
    "enable_manual_intervention": true,
    "show_retry_dialog": false,
    "auto_skip_failed_elements": false
  }
}
```

**3.2 åˆ›å»ºé‡è¯•ç®¡ç†å™¨ç±»**

**æ–°å¢æ–‡ä»¶ï¼š** `retry_manager.py`

**å…·ä½“å®ç°ï¼š**
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
é‡è¯•ç®¡ç†å™¨

è´Ÿè´£ç®¡ç†éªŒè¯ç åçš„é‡è¯•é€»è¾‘ï¼ŒåŒ…æ‹¬é…ç½®ç®¡ç†ã€é‡è¯•ç­–ç•¥å’ŒçŠ¶æ€è·Ÿè¸ª
"""

import json
import os
import time
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Tuple

class RetryManager:
    """é‡è¯•ç®¡ç†å™¨ç±»"""
    
    def __init__(self, config_file="retry_config.json"):
        self.config_file = config_file
        self.config = self._load_config()
        self.retry_attempts = {}
        self.retry_history = []
    
    def _load_config(self) -> Dict:
        """åŠ è½½é‡è¯•é…ç½®"""
        try:
            if os.path.exists(self.config_file):
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            else:
                # è¿”å›é»˜è®¤é…ç½®
                return self._get_default_config()
        except Exception as e:
            print(f"åŠ è½½é‡è¯•é…ç½®å¤±è´¥: {e}")
            return self._get_default_config()
    
    def _get_default_config(self) -> Dict:
        """è·å–é»˜è®¤é…ç½®"""
        return {
            "retry_settings": {
                "max_retry_attempts": 3,
                "retry_delay_seconds": 2.0,
                "use_coordinate_cache": True,
                "cache_expiry_hours": 24,
                "retry_strategies": [
                    "cached_coordinates",
                    "smart_element_search",
                    "fallback_xpath"
                ],
                "enable_retry_logging": True,
                "retry_timeout_seconds": 30
            }
        }
    
    def should_retry(self, element_name: str, order_index: int) -> bool:
        """åˆ¤æ–­æ˜¯å¦åº”è¯¥é‡è¯•"""
        key = f"{element_name}_{order_index}"
        attempts = self.retry_attempts.get(key, 0)
        max_attempts = self.config["retry_settings"]["max_retry_attempts"]
        
        return attempts < max_attempts
    
    def record_retry_attempt(self, element_name: str, order_index: int, success: bool) -> None:
        """è®°å½•é‡è¯•å°è¯•"""
        key = f"{element_name}_{order_index}"
        self.retry_attempts[key] = self.retry_attempts.get(key, 0) + 1
        
        # è®°å½•é‡è¯•å†å²
        self.retry_history.append({
            "timestamp": datetime.now().isoformat(),
            "element_name": element_name,
            "order_index": order_index,
            "attempt_number": self.retry_attempts[key],
            "success": success
        })
    
    def get_retry_delay(self) -> float:
        """è·å–é‡è¯•å»¶è¿Ÿæ—¶é—´"""
        return self.config["retry_settings"]["retry_delay_seconds"]
    
    def get_retry_strategies(self) -> List[str]:
        """è·å–é‡è¯•ç­–ç•¥åˆ—è¡¨"""
        return self.config["retry_settings"]["retry_strategies"]
    
    def reset_retry_attempts(self, element_name: str = None, order_index: int = None) -> None:
        """é‡ç½®é‡è¯•è®¡æ•°"""
        if element_name and order_index:
            key = f"{element_name}_{order_index}"
            if key in self.retry_attempts:
                del self.retry_attempts[key]
        else:
            self.retry_attempts.clear()
    
    def get_retry_statistics(self) -> Dict:
        """è·å–é‡è¯•ç»Ÿè®¡ä¿¡æ¯"""
        total_attempts = len(self.retry_history)
        successful_retries = sum(1 for h in self.retry_history if h["success"])
        
        return {
            "total_retry_attempts": total_attempts,
            "successful_retries": successful_retries,
            "success_rate": successful_retries / total_attempts if total_attempts > 0 else 0,
            "retry_history": self.retry_history[-10:]  # æœ€è¿‘10æ¬¡é‡è¯•è®°å½•
        }
```

### ğŸ“ˆ æ€»ä½“è¿›åº¦è·Ÿè¸ª

#### å½“å‰çŠ¶æ€
- [x] **é˜¶æ®µä¸€ï¼šåŸºç¡€é‡è¯•æœºåˆ¶** - âœ… å·²å®Œæˆ (100%)
- [x] **é˜¶æ®µäºŒï¼šåæ ‡ç¼“å­˜ä¼˜åŒ–** - âœ… å·²å®Œæˆ (100%)
- [x] **é˜¶æ®µä¸‰ï¼šé…ç½®åŒ–å¢å¼º** - âœ… å·²å®Œæˆ (100%)

#### é‡Œç¨‹ç¢‘æ£€æŸ¥ç‚¹

**ğŸ¯ é‡Œç¨‹ç¢‘1ï¼šåŸºç¡€åŠŸèƒ½éªŒè¯**
**ç›®æ ‡æ—¥æœŸï¼š** å®æ–½å¼€å§‹å1-2å¤© âœ… **å·²å®Œæˆ**
- [x] éªŒè¯ç æ¶ˆå¤±åèƒ½è§¦å‘é‡è¯•
- [x] é‡è¯•ä¸å½±å“æ­£å¸¸æµç¨‹
- [x] åŸºç¡€æ—¥å¿—è®°å½•æ­£å¸¸

**ğŸ¯ é‡Œç¨‹ç¢‘2ï¼šæ€§èƒ½ä¼˜åŒ–éªŒè¯**
**ç›®æ ‡æ—¥æœŸï¼š** å®æ–½å¼€å§‹å3-5å¤©
- [ ] åæ ‡ç¼“å­˜ç³»ç»Ÿç¨³å®šè¿è¡Œ
- [ ] é‡è¯•æˆåŠŸç‡æ˜¾è‘—æå‡
- [ ] ç¼“å­˜æ–‡ä»¶ç®¡ç†æ­£å¸¸

**ğŸ¯ é‡Œç¨‹ç¢‘3ï¼šå®Œæ•´åŠŸèƒ½éªŒè¯**
**ç›®æ ‡æ—¥æœŸï¼š** å®æ–½å¼€å§‹å6-8å¤©
- [ ] æ‰€æœ‰é…ç½®é€‰é¡¹æ­£å¸¸å·¥ä½œ
- [ ] é‡è¯•ç»Ÿè®¡å’Œç›‘æ§å®Œå–„
- [ ] ç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§è‰¯å¥½

---

## éªŒè¯ç æ£€æµ‹å¼‚æ­¥ä¿®å¤æ–¹æ¡ˆ

### ğŸ“‹ é—®é¢˜æè¿°
éªŒè¯ç æ£€æµ‹ä¸ä¸»å¾ªç¯æš‚åœé€»è¾‘ä¹‹é—´å­˜åœ¨æ—¶åºé—®é¢˜ï¼Œå¯¼è‡´ç¨‹åºåœ¨æ£€æµ‹åˆ°éªŒè¯ç åä»ç»§ç»­æ‰§è¡Œæ“ä½œï¼Œæ— æ³•åŠæ—¶å“åº”æš‚åœæŒ‡ä»¤ã€‚

### ğŸ¯ ä¿®å¤ç›®æ ‡
é€šè¿‡æœ€å°‘çš„ä»£ç ä¿®æ”¹ï¼Œå®ç°éªŒè¯ç æ£€æµ‹åçš„ç«‹å³æš‚åœå“åº”ã€‚

### ğŸ”§ å®æ–½æ–¹æ¡ˆ

#### ä¿®æ”¹1ï¼šåœ¨ `data_processor.py` ä¸­æ·»åŠ æš‚åœæ£€æŸ¥

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\data_processor.py`

**ä¿®æ”¹ç›®æ ‡ï¼š** `_execute_operation()` æ–¹æ³•ï¼ˆçº¦ç¬¬247è¡Œå¼€å§‹ï¼‰

**å…·ä½“å®ç°ï¼š**
```python
def _execute_operation(self, operation):
    """æ‰§è¡Œå•ä¸ªæ“ä½œï¼Œæ·»åŠ æš‚åœæ£€æŸ¥"""
    import time
    
    # æ·»åŠ æš‚åœæ£€æŸ¥ - æ–°å¢åŠŸèƒ½
    if hasattr(self, 'is_paused') and self.is_paused:
        self._log_info(f"æ“ä½œå·²æš‚åœï¼Œè·³è¿‡æ‰§è¡Œ: {operation.get('name', 'æœªçŸ¥æ“ä½œ')}", "orange")
        return None
    
    if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
        self._log_info(f"æ£€æµ‹åˆ°éªŒè¯ç ï¼Œè·³è¿‡æ‰§è¡Œ: {operation.get('name', 'æœªçŸ¥æ“ä½œ')}", "red")
        return None
    
    # æ£€æŸ¥pyautoguiä¾èµ–
    if 'pyautogui' not in globals():
        self._log_info("pyautoguiæ¨¡å—æœªæ­£ç¡®å¯¼å…¥ï¼Œè¯·å®‰è£…: pip install pyautogui", "red")
        return None
        
    try:
        if not self.driver:
            self._log_info("æµè§ˆå™¨æœªè¿æ¥ï¼Œæ— æ³•æ‰§è¡Œæ“ä½œ", "red")
            return None
            
        xpath = operation.get("smart_xpath") or operation["xpath"]
        action = operation["action"]
        name = operation["name"]
        
        # åœ¨å…ƒç´ æŸ¥æ‰¾å‰å†æ¬¡æ£€æŸ¥æš‚åœçŠ¶æ€ - æ–°å¢åŠŸèƒ½
        if hasattr(self, 'is_paused') and self.is_paused:
            self._log_info(f"å…ƒç´ æŸ¥æ‰¾å‰æ£€æµ‹åˆ°æš‚åœ: {name}", "orange")
            return None
        
        if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
            self._log_info(f"å…ƒç´ æŸ¥æ‰¾å‰æ£€æµ‹åˆ°éªŒè¯ç : {name}", "red")
            return None
        
        # ä½¿ç”¨æ™ºèƒ½å®šä½æŸ¥æ‰¾å…ƒç´ 
        element = self._find_element_smart(name, xpath)
            
        if not element:
            self._log_info(f"æœªæ‰¾åˆ°å…ƒç´ : {name}", "red")
            return None
        
        # åœ¨ç‚¹å‡»å‰å†æ¬¡æ£€æŸ¥æš‚åœçŠ¶æ€ - æ–°å¢åŠŸèƒ½
        if hasattr(self, 'is_paused') and self.is_paused:
            self._log_info(f"ç‚¹å‡»å‰æ£€æµ‹åˆ°æš‚åœ: {name}", "orange")
            return None
        
        if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
            self._log_info(f"ç‚¹å‡»å‰æ£€æµ‹åˆ°éªŒè¯ç : {name}", "red")
            return None
        
        # ... å…¶ä½™ä»£ç ä¿æŒä¸å˜ ...
```

#### ä¿®æ”¹2ï¼šä¼˜åŒ– `captcha_detector.py` ä¸­çš„çŠ¶æ€æ¸…ç†

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\captcha_detector.py`

**ä¿®æ”¹ç›®æ ‡ï¼š** `_on_captcha_disappeared()` æ–¹æ³•ï¼ˆçº¦ç¬¬560è¡Œï¼‰

**å…·ä½“å®ç°ï¼š**
```python
def _on_captcha_disappeared(self):
    """éªŒè¯ç æ¶ˆå¤±æ—¶çš„å¤„ç†"""
    try:
        # æ¸…é™¤æ‰€æœ‰æš‚åœæ ‡å¿— - ä¿®æ”¹åŠŸèƒ½
        if hasattr(self, 'force_stop_flag'):
            self.force_stop_flag = False
        if hasattr(self, 'is_paused'):
            self.is_paused = False
        
        self._log_info("éªŒè¯ç å·²æ¶ˆå¤±ï¼Œæ¢å¤æ“ä½œæ‰§è¡Œ", "green")
        self._update_captcha_status_display()
        
        # è®¾ç½®é‡è¯•æ ‡å¿—
        self.retry_current_order = True
        self.root.after(0, self._trigger_order_retry)
        
    except Exception as e:
        self._log_info(f"å¤„ç†éªŒè¯ç æ¶ˆå¤±äº‹ä»¶å‡ºé”™: {e}", "error")
```

#### ä¿®æ”¹3ï¼šä¿®å¤é‡è¯•æœºåˆ¶å†²çª

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\data_processor.py`

**ä¿®æ”¹ç›®æ ‡ï¼š** `run_actions_loop()` æ–¹æ³•ä¸­çš„é‡è¯•é€»è¾‘ï¼ˆçº¦ç¬¬126-130è¡Œï¼‰

**å…·ä½“å®ç°ï¼š**
```python
# åœ¨é‡è¯•æ ‡å¿—æ£€æŸ¥å‰æ·»åŠ æš‚åœçŠ¶æ€éªŒè¯
if hasattr(self, 'retry_current_order') and self.retry_current_order:
    # æ£€æŸ¥æš‚åœçŠ¶æ€ï¼Œç¡®ä¿é‡è¯•æ—¶ä¸ä¼šä¸æš‚åœå†²çª
    if hasattr(self, 'is_paused') and self.is_paused:
        self._log_info("[é‡è¯•] æ£€æµ‹åˆ°æš‚åœçŠ¶æ€ï¼Œç­‰å¾…æ¢å¤åé‡è¯•", "orange")
        # ç­‰å¾…æš‚åœçŠ¶æ€è§£é™¤
        while hasattr(self, 'is_paused') and self.is_paused and self.is_running:
            time.sleep(0.5)
            self.root.update()
        if not self.is_running:
            break
    
    if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
        self._log_info("[é‡è¯•] æ£€æµ‹åˆ°éªŒè¯ç ï¼Œç­‰å¾…å¤„ç†åé‡è¯•", "red")
        # ç­‰å¾…éªŒè¯ç æ¶ˆå¤±
        while hasattr(self, 'force_stop_flag') and self.force_stop_flag and self.is_running:
            time.sleep(0.5)
            self.root.update()
        if not self.is_running:
            break
    
    self.retry_current_order = False  # é‡ç½®é‡è¯•æ ‡å¿—
    self.current_order_index = i  # ä¿å­˜å½“å‰è®¢å•ç´¢å¼•
    self._log_info(f"[é‡è¯•] é‡æ–°å¤„ç†ç¬¬ {i}/{num_items} ä¸ªè®¢å•", "orange")
else:
    self._log_info(f"[å¾ªç¯] æ­£åœ¨å¤„ç†ç¬¬ {i}/{num_items} ä¸ªè®¢å•", "blue")
```

### ğŸ“Š è¾¾æˆåº¦è¯„ä¼°æ ‡å‡†

#### âœ… å®Œå…¨è¾¾æˆ (100%)
- [ ] `_execute_operation` æ–¹æ³•åœ¨3ä¸ªå…³é”®ç‚¹æ·»åŠ æš‚åœæ£€æŸ¥
- [ ] éªŒè¯ç æ£€æµ‹åæ“ä½œç«‹å³åœæ­¢
- [ ] `_on_captcha_disappeared` æ­£ç¡®æ¸…é™¤æ‰€æœ‰æš‚åœæ ‡å¿—
- [ ] é‡è¯•æœºåˆ¶ä¸æš‚åœæ£€æŸ¥åè°ƒå·¥ä½œï¼Œæ— å†²çª
- [ ] æ‰‹åŠ¨æš‚åœ/ç»§ç»­åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] ç°æœ‰æ“ä½œæµç¨‹æ— å¼‚å¸¸
- [ ] éªŒè¯ç æ£€æµ‹å“åº”æ—¶é—´ < 500ms

### ğŸ” éªŒè¯æ–¹æ³•
1. æ¨¡æ‹ŸéªŒè¯ç æ£€æµ‹è§¦å‘
2. æ£€æŸ¥æ“ä½œæ˜¯å¦ç«‹å³åœæ­¢
3. éªŒè¯çŠ¶æ€æ ‡å¿—åŒæ­¥æ€§
4. æµ‹è¯•æ‰‹åŠ¨æš‚åœ/ç»§ç»­åŠŸèƒ½
5. éªŒè¯é‡è¯•æœºåˆ¶ä¸æš‚åœæ£€æŸ¥çš„åè°ƒæ€§
6. æµ‹è¯•éªŒè¯ç æ¶ˆå¤±åçš„è‡ªåŠ¨é‡è¯•åŠŸèƒ½

### ğŸ“ å®æ–½æ³¨æ„äº‹é¡¹

#### âš ï¸ é£é™©æ§åˆ¶
- å®æ–½å‰å¤‡ä»½ç›¸å…³æ–‡ä»¶
- é€æ­¥æµ‹è¯•æ¯ä¸ªä¿®æ”¹ç‚¹
- ç¡®ä¿ä¸å½±å“ç°æœ‰åŠŸèƒ½

#### ğŸ”§ æŠ€æœ¯è¦æ±‚
- éµå¾ªç°æœ‰ä»£ç é£æ ¼
- æ·»åŠ å¿…è¦çš„å¼‚å¸¸å¤„ç†
- ä¿æŒæ—¥å¿—è¾“å‡ºä¸€è‡´æ€§

---

## é—®é¢˜ä¿®å¤æŠ¥å‘Šé›†åˆ

### éªŒè¯ç æ£€æµ‹æš‚åœæœºåˆ¶ä¿®å¤æŠ¥å‘Š

#### ğŸ› é—®é¢˜æè¿°

**é”™è¯¯ç°è±¡**
ä»æ—¥å¿—æ–‡ä»¶ `æ”¶è´§ä¿¡æ¯è‡ªåŠ¨é‡‡é›†å·¥å…·.log` ä¸­å‘ç°éªŒè¯ç æ£€æµ‹åç¨‹åºä»ç»§ç»­æ‰§è¡Œæ»šåŠ¨æ“ä½œçš„é—®é¢˜ï¼š

```
2025-07-29 13:05:52 - INFO - æ£€æµ‹åˆ°éªŒè¯ç ï¼Œè‡ªåŠ¨æš‚åœæ“ä½œ
2025-07-29 13:05:53 - INFO - å°è¯•ä½¿ç”¨å‚ç…§ç‚¹è®¡ç®—æ»šåŠ¨è·ç¦»
2025-07-29 13:05:53 - INFO - ç›´æ¥æ»šåŠ¨æ•´ä¸ªé¡µé¢ 54.842579750346744px
2025-07-29 13:06:06 - INFO - éªŒè¯ç å·²æ¶ˆå¤±ï¼Œæ¢å¤æ“ä½œæ‰§è¡Œ
```

**é”™è¯¯åŸå› **
1. **æ»šåŠ¨æ–¹æ³•ç¼ºå°‘æš‚åœæ£€æŸ¥**ï¼š`_scroll_with_javascript()` æ–¹æ³•æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œä½†æ²¡æœ‰æ£€æŸ¥éªŒè¯ç çŠ¶æ€
2. **æ»šåŠ¨æ­¥éª¤ç¼ºå°‘çŠ¶æ€æ£€æŸ¥**ï¼šåœ¨æ»šåŠ¨çš„åˆ†æ­¥æ‰§è¡Œä¸­ï¼Œæ¯ä¸ªæ­¥éª¤ä¹‹é—´æ²¡æœ‰éªŒè¯ç æ£€æŸ¥
3. **é‡è¯•å¾ªç¯ç¼ºå°‘æ£€æŸ¥**ï¼šæ»šåŠ¨é‡è¯•è¿‡ç¨‹ä¸­æ²¡æœ‰åŠæ—¶å“åº”æš‚åœçŠ¶æ€
4. **æ–¹æ³•å¾ªç¯ç¼ºå°‘æ£€æŸ¥**ï¼šå°è¯•ä¸åŒæ»šåŠ¨æ–¹æ³•æ—¶æ²¡æœ‰çŠ¶æ€æ£€æŸ¥

#### ğŸ”§ ä¿®å¤å†…å®¹

**ä¿®å¤æ–‡ä»¶ï¼š** `f:\shoujifahuoxinxi\data_processor.py`

**ä¿®å¤ç‚¹1ï¼š** `_scroll_with_javascript()` æ–¹æ³•å¼€å§‹å¤„ï¼ˆç¬¬1533è¡Œï¼‰
```python
# æ£€æŸ¥éªŒè¯ç å’Œæš‚åœçŠ¶æ€ - ä¿®å¤ç‚¹1
if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
    self._log_info("æ£€æµ‹åˆ°éªŒè¯ç ï¼Œåœæ­¢æ»šåŠ¨æ“ä½œ", "red")
    return False
    
if hasattr(self, 'is_paused') and self.is_paused:
    self._log_info("æ£€æµ‹åˆ°æš‚åœçŠ¶æ€ï¼Œåœæ­¢æ»šåŠ¨æ“ä½œ", "orange")
    return False
```

**ä¿®å¤ç‚¹2ï¼š** æ»šåŠ¨æ­¥éª¤å¾ªç¯ä¸­ï¼ˆç¬¬1651è¡Œï¼‰
```python
# æ£€æŸ¥éªŒè¯ç å’Œæš‚åœçŠ¶æ€ - ä¿®å¤ç‚¹2
if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
    self._log_info(f"æ»šåŠ¨æ­¥éª¤ {i+1}/{steps} ä¸­æ£€æµ‹åˆ°éªŒè¯ç ï¼Œåœæ­¢æ»šåŠ¨", "red")
    return False
    
if hasattr(self, 'is_paused') and self.is_paused:
    self._log_info(f"æ»šåŠ¨æ­¥éª¤ {i+1}/{steps} ä¸­æ£€æµ‹åˆ°æš‚åœçŠ¶æ€ï¼Œåœæ­¢æ»šåŠ¨", "orange")
    return False
```

**ä¿®å¤ç‚¹3ï¼š** æ»šåŠ¨é‡è¯•å¾ªç¯ä¸­ï¼ˆç¬¬1324è¡Œï¼‰
```python
# æ£€æŸ¥éªŒè¯ç å’Œæš‚åœçŠ¶æ€ - ä¿®å¤ç‚¹3
if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
    self._log_info(f"æ»šåŠ¨é‡è¯• {retry+1}/{max_retries} ä¸­æ£€æµ‹åˆ°éªŒè¯ç ï¼Œåœæ­¢æ»šåŠ¨", "red")
    return False
    
if hasattr(self, 'is_paused') and self.is_paused:
    self._log_info(f"æ»šåŠ¨é‡è¯• {retry+1}/{max_retries} ä¸­æ£€æµ‹åˆ°æš‚åœçŠ¶æ€ï¼Œåœæ­¢æ»šåŠ¨", "orange")
    return False
```

**ä¿®å¤ç‚¹4ï¼š** æ»šåŠ¨æ–¹æ³•å¾ªç¯ä¸­ï¼ˆç¬¬1382è¡Œï¼‰
```python
# æ£€æŸ¥éªŒè¯ç å’Œæš‚åœçŠ¶æ€ - ä¿®å¤ç‚¹4
if hasattr(self, 'force_stop_flag') and self.force_stop_flag:
    self._log_info(f"æ»šåŠ¨æ–¹æ³• {method.__name__} æ‰§è¡Œå‰æ£€æµ‹åˆ°éªŒè¯ç ï¼Œåœæ­¢æ»šåŠ¨", "red")
    return False
    
if hasattr(self, 'is_paused') and self.is_paused:
    self._log_info(f"æ»šåŠ¨æ–¹æ³• {method.__name__} æ‰§è¡Œå‰æ£€æµ‹åˆ°æš‚åœçŠ¶æ€ï¼Œåœæ­¢æ»šåŠ¨", "orange")
    return False
```

#### ğŸ“Š ä¿®å¤æ•ˆæœ

**ä¿®å¤å‰ï¼š**
- éªŒè¯ç æ£€æµ‹åç¨‹åºä»ç»§ç»­æ‰§è¡Œ1-2ä¸ªæ»šåŠ¨æ“ä½œ
- æ»šåŠ¨æ“ä½œå¯èƒ½æŒç»­10-15ç§’æ‰åœæ­¢
- å¯èƒ½å¯¼è‡´é¡µé¢çŠ¶æ€æ··ä¹±

**ä¿®å¤åï¼š**
- éªŒè¯ç æ£€æµ‹åç«‹å³åœæ­¢æ‰€æœ‰æ»šåŠ¨æ“ä½œ
- å“åº”æ—¶é—´ < 500ms
- é¿å…é¡µé¢çŠ¶æ€æ··ä¹±
- æé«˜éªŒè¯ç å¤„ç†çš„åŠæ—¶æ€§

#### âœ… éªŒè¯æ–¹æ³•

1. **æ¨¡æ‹ŸéªŒè¯ç è§¦å‘**ï¼šæ‰‹åŠ¨è§¦å‘éªŒè¯ç æ£€æµ‹
2. **æ£€æŸ¥åœæ­¢å“åº”**ï¼šéªŒè¯æ»šåŠ¨æ“ä½œæ˜¯å¦ç«‹å³åœæ­¢
3. **æ—¥å¿—éªŒè¯**ï¼šæ£€æŸ¥æ˜¯å¦è¾“å‡ºç›¸åº”çš„åœæ­¢æ—¥å¿—
4. **çŠ¶æ€ä¸€è‡´æ€§**ï¼šéªŒè¯æš‚åœçŠ¶æ€çš„åŒæ­¥æ€§

#### ğŸ“ æ³¨æ„äº‹é¡¹

- æ‰€æœ‰æ»šåŠ¨ç›¸å…³æ–¹æ³•ç°åœ¨éƒ½ä¼šæ£€æŸ¥éªŒè¯ç å’Œæš‚åœçŠ¶æ€
- æ£€æŸ¥ç‚¹åˆ†å¸ƒåœ¨æ»šåŠ¨æ“ä½œçš„å…³é”®ä½ç½®
- ä¿æŒäº†åŸæœ‰çš„æ—¥å¿—è¾“å‡ºæ ¼å¼å’Œé”™è¯¯å¤„ç†æœºåˆ¶
- ä¸å½±å“æ­£å¸¸çš„æ»šåŠ¨åŠŸèƒ½

---

### åæ ‡ç¼“å­˜KeyErrorä¿®å¤æŠ¥å‘Š

#### ğŸ› é—®é¢˜æè¿°

**é”™è¯¯ç°è±¡**
ä»æ—¥å¿—æ–‡ä»¶ `æ”¶è´§ä¿¡æ¯è‡ªåŠ¨é‡‡é›†å·¥å…·.log` ä¸­å‘ç°ä»¥ä¸‹é”™è¯¯ï¼š

```
æ‰§è¡Œ'æŸ¥çœ‹1'æ“ä½œå¤±è´¥: 'x'
Traceback (most recent call last):
  File "f:\shoujifahuoxinxi\data_processor.py", line 400, in _execute_operation
    screen_x = cached_coords['x']
KeyError: 'x'
```

**é”™è¯¯åŸå› **
1. **åæ ‡æ ¼å¼ä¸ä¸€è‡´**ï¼šåæ ‡ç¼“å­˜æ–‡ä»¶ä½¿ç”¨ `screen_x`/`screen_y` æ ¼å¼å­˜å‚¨åæ ‡
2. **ä»£ç è®¿é—®é”™è¯¯**ï¼š`_execute_operation` æ–¹æ³•ä¸­é”™è¯¯åœ°å°è¯•è®¿é—® `cached_coords['x']`
3. **æ ¼å¼å…¼å®¹æ€§é—®é¢˜**ï¼šæ–°æ—§åæ ‡æ ¼å¼ä¹‹é—´ç¼ºä¹å…¼å®¹æ€§å¤„ç†

#### ğŸ”§ ä¿®å¤å†…å®¹

**1. ä¿®å¤ `_execute_operation` æ–¹æ³•ä¸­çš„åæ ‡è®¿é—®**

**æ–‡ä»¶**: `data_processor.py` ç¬¬398-410è¡Œ

**ä¿®å¤å‰**:
```python
screen_x = cached_coords['x']
screen_y = cached_coords['y']
```

**ä¿®å¤å**:
```python
# ä¿®å¤åæ ‡å­—æ®µåç§°
if 'screen_x' in cached_coords and 'screen_y' in cached_coords:
    screen_x = cached_coords['screen_x']
    screen_y = cached_coords['screen_y']
elif 'x' in cached_coords and 'y' in cached_coords:
    screen_x = cached_coords['x']
    screen_y = cached_coords['y']
else:
    self._log_info(f"è™šæ‹Ÿå…ƒç´ '{name}'çš„åæ ‡æ ¼å¼é”™è¯¯: {cached_coords}", "red")
    return None
```

**2. å¢å¼º `_create_virtual_element` æ–¹æ³•çš„åæ ‡éªŒè¯**

**æ–‡ä»¶**: `data_processor.py` ç¬¬967-971è¡Œ

**ä¿®å¤å‰**:
```python
if not cached_coords or 'x' not in cached_coords or 'y' not in cached_coords:
    self._log_info(f"ç¼“å­˜åæ ‡æ— æ•ˆ: {cached_coords}", "red")
    return None
```

**ä¿®å¤å**:
```python
has_screen_coords = cached_coords and 'screen_x' in cached_coords and 'screen_y' in cached_coords
has_xy_coords = cached_coords and 'x' in cached_coords and 'y' in cached_coords

if not cached_coords or (not has_screen_coords and not has_xy_coords):
    self._log_info(f"ç¼“å­˜åæ ‡æ— æ•ˆ: {cached_coords}", "red")
    return None
```

#### âœ… éªŒè¯ç»“æœ

**æµ‹è¯•è„šæœ¬éªŒè¯**
åˆ›å»ºäº† `verify_coordinate_fix.py` éªŒè¯è„šæœ¬ï¼Œæµ‹è¯•ç»“æœï¼š

```
==================================================
åæ ‡ç¼“å­˜ä¿®å¤éªŒè¯
==================================================
æµ‹è¯•ç¼“å­˜æ–‡ä»¶æ ¼å¼... âœ“ ç¼“å­˜æ–‡ä»¶æ ¼å¼æ­£ç¡®
æµ‹è¯•åæ ‡æ ¼å¼å…¼å®¹æ€§... âœ“ åæ ‡æ ¼å¼å…¼å®¹æ€§æµ‹è¯•é€šè¿‡
æµ‹è¯•åæ ‡è®¿é—®é€»è¾‘... âœ“ åæ ‡è®¿é—®é€»è¾‘æµ‹è¯•é€šè¿‡

==================================================
æµ‹è¯•ç»“æœ: 3/3 é€šè¿‡

ğŸ‰ åæ ‡ç¼“å­˜KeyError 'x'é—®é¢˜å·²ä¿®å¤ï¼
```

**åŠŸèƒ½éªŒè¯**
- âœ… æ”¯æŒ `screen_x`/`screen_y` æ ¼å¼åæ ‡
- âœ… å…¼å®¹æ—§çš„ `x`/`y` æ ¼å¼åæ ‡
- âœ… å¢å¼ºäº†é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º
- âœ… ä¿®å¤äº† `_execute_operation` ä¸­çš„ KeyError
- âœ… ä¿æŒäº†ä¸ç°æœ‰ç¼“å­˜æ–‡ä»¶çš„å…¼å®¹æ€§

---

### é‡è¯•åæ ‡é—®é¢˜ä¿®å¤æŠ¥å‘Š

#### ğŸ“‹ é—®é¢˜æè¿°

**é—®é¢˜ç°è±¡**
ä»ç”¨æˆ·æä¾›çš„æ—¥å¿—æ–‡ä»¶ `æ”¶è´§ä¿¡æ¯è‡ªåŠ¨é‡‡é›†å·¥å…·.log` ä¸­å‘ç°ï¼Œåœ¨éªŒè¯ç æ¶ˆå¤±åçš„é‡è¯•è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä½¿ç”¨ç¼“å­˜åæ ‡è¿›è¡Œç‚¹å‡»æ—¶å‡ºç°ä½ç½®é”™è¯¯çš„é—®é¢˜ã€‚

**å…³é”®æ—¥å¿—åˆ†æ**
```
2025-07-29 00:55:26,164 - INFO - éªŒè¯ç å·²æ¶ˆå¤±ï¼Œæ¢å¤æ“ä½œæ‰§è¡Œ
2025-07-29 00:55:26,599 - INFO - [ç¼“å­˜] ä½¿ç”¨å…ƒç´ 'æŸ¥çœ‹2'çš„ç¼“å­˜åæ ‡è¿›è¡Œé‡è¯•
2025-07-29 00:55:26,603 - INFO - æˆåŠŸåˆ›å»ºå¢å¼ºè™šæ‹Ÿå…ƒç´  'æŸ¥çœ‹2' ä½¿ç”¨åæ ‡: (1224, 553)
```

**é—®é¢˜æ ¹æº**
1. **é‡è¯•é€»è¾‘é”™è¯¯**ï¼šç³»ç»Ÿåœ¨é‡è¯•æ¨¡å¼ä¸‹ç›´æ¥ä½¿ç”¨ç¼“å­˜åæ ‡ï¼Œè€Œä¸æ˜¯å…ˆå°è¯•æ­£å¸¸çš„å…ƒç´ æŸ¥æ‰¾æ–¹æ³•
2. **åæ ‡åç§»é—®é¢˜**ï¼šé¡µé¢æ»šåŠ¨åï¼Œç¼“å­˜çš„ç»å¯¹åæ ‡ä¸å†å‡†ç¡®ï¼Œå¯¼è‡´ç‚¹å‡»ä½ç½®é”™è¯¯

#### ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

**ä¿®å¤1ï¼šé‡è¯•é€»è¾‘ä¼˜åŒ–**

**æ–‡ä»¶**ï¼š`data_processor.py`
**ä½ç½®**ï¼š`_find_element_smart` æ–¹æ³•ï¼ˆç¬¬657-665è¡Œï¼‰

**ä¿®å¤å‰**ï¼š
```python
if hasattr(self, 'retry_current_order') and self.retry_current_order and self.retry_manager.is_coordinate_cache_enabled():
    # é‡è¯•æ¨¡å¼ä¸‹ä¼˜å…ˆæ£€æŸ¥ç¼“å­˜åæ ‡
    cached_coords = self._load_cached_coordinates(name)
    if cached_coords and self.retry_manager.is_coordinate_valid(cached_coords):
        self._log_info(f"[ç¼“å­˜] ä½¿ç”¨å…ƒç´ '{name}'çš„ç¼“å­˜åæ ‡è¿›è¡Œé‡è¯•", "cyan")
        return self._create_virtual_element_enhanced(name, cached_coords)
```

**ä¿®å¤å**ï¼š
```python
# æ³¨æ„ï¼šé‡è¯•æ¨¡å¼ä¸‹ä¸ç›´æ¥ä½¿ç”¨ç¼“å­˜åæ ‡ï¼Œè€Œæ˜¯å…ˆå°è¯•æ­£å¸¸çš„å…ƒç´ æŸ¥æ‰¾æ–¹æ³•
# ç¼“å­˜åæ ‡åªä½œä¸ºæ‰€æœ‰ç­–ç•¥éƒ½å¤±è´¥æ—¶çš„æœ€åå¤‡é€‰æ–¹æ¡ˆ
```

**ä¿®å¤2ï¼šç­–ç•¥6æ¡ä»¶ä¼˜åŒ–**

**æ–‡ä»¶**ï¼š`data_processor.py`
**ä½ç½®**ï¼šç­–ç•¥6ï¼ˆç¬¬814-828è¡Œï¼‰

**ä¿®å¤å‰**ï¼š
```python
if self.coordinate_cache.should_use_cache():
```

**ä¿®å¤å**ï¼š
```python
if (hasattr(self, 'retry_current_order') and self.retry_current_order and 
    hasattr(self, 'retry_manager') and self.retry_manager.is_coordinate_cache_enabled()):
```

**ä¿®å¤3ï¼šåæ ‡åŠ¨æ€è°ƒæ•´**

**æ–‡ä»¶**ï¼š`data_processor.py`
**ä½ç½®**ï¼š`_create_virtual_element_enhanced` æ–¹æ³•ï¼ˆç¬¬852-902è¡Œï¼‰

**æ–°å¢åŠŸèƒ½**ï¼š
```python
# è·å–å½“å‰é¡µé¢æ»šåŠ¨ä½ç½®ï¼ŒåŠ¨æ€è°ƒæ•´åæ ‡
try:
    current_scroll_y = self.driver.execute_script("return window.pageYOffset || document.documentElement.scrollTop;")
    cached_scroll_y = cached_coords.get('scroll_y', 0)  # ç¼“å­˜æ—¶çš„æ»šåŠ¨ä½ç½®
    scroll_offset = current_scroll_y - cached_scroll_y
    
    # è°ƒæ•´Yåæ ‡
    adjusted_screen_y = cached_coords['screen_y'] - scroll_offset
```

**ä¿®å¤4ï¼šåæ ‡ä¿å­˜å¢å¼º**

**æ–‡ä»¶**ï¼š`data_processor.py`
**ä½ç½®**ï¼š`_save_successful_coordinates_enhanced` æ–¹æ³•ï¼ˆç¬¬922-960è¡Œï¼‰

**æ–°å¢åŠŸèƒ½**ï¼š
```python
# è·å–å½“å‰é¡µé¢æ»šåŠ¨ä½ç½®
try:
    current_scroll_y = self.driver.execute_script("return window.pageYOffset || document.documentElement.scrollTop;")
except Exception as e:
    self._log_info(f"è·å–æ»šåŠ¨ä½ç½®å¤±è´¥: {e}", "orange")
    current_scroll_y = 0

# åœ¨åæ ‡ä¿¡æ¯ä¸­æ·»åŠ æ»šåŠ¨ä½ç½®
'scroll_y': current_scroll_y,  # è®°å½•ä¿å­˜æ—¶çš„æ»šåŠ¨ä½ç½®
```

#### ğŸ“Š ä¿®å¤éªŒè¯

**æµ‹è¯•è„šæœ¬**
åˆ›å»ºäº† `test_retry_coordinate_fix.py` æµ‹è¯•è„šæœ¬ï¼ŒéªŒè¯ä¿®å¤æ•ˆæœï¼š

```
=== é‡è¯•åæ ‡ä¿®å¤æµ‹è¯• ===
âœ… æ­£ç¡®ï¼šé‡è¯•æ¨¡å¼ä¸‹å…ˆå°è¯•æ­£å¸¸å…ƒç´ æŸ¥æ‰¾
âœ… æ­£ç¡®ï¼šåªæœ‰åœ¨æ‰€æœ‰ç­–ç•¥å¤±è´¥æ—¶æ‰ä½¿ç”¨ç¼“å­˜åæ ‡
âœ… ç¼“å­˜æ–‡ä»¶æ ¼å¼æ­£ç¡®
âœ… æ—¥å¿—æ ¼å¼æ­£ç¡®

=== åæ ‡å‡†ç¡®æ€§æµ‹è¯• ===
âœ… é¡µé¢æ»šåŠ¨å½±å“æµ‹è¯•é€šè¿‡
ğŸ’¡ å»ºè®®ï¼šåœ¨ä½¿ç”¨ç¼“å­˜åæ ‡æ—¶è€ƒè™‘å½“å‰é¡µé¢æ»šåŠ¨ä½ç½®ï¼ˆå·²å®ç°ï¼‰

ğŸ‰ ä¿®å¤éªŒè¯æˆåŠŸï¼
```

**ä¿®å¤å‰åå¯¹æ¯”**

| æ–¹é¢ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| **é‡è¯•ç­–ç•¥** | ç›´æ¥ä½¿ç”¨ç¼“å­˜åæ ‡ | å…ˆå°è¯•æ­£å¸¸æŸ¥æ‰¾ï¼Œå¤±è´¥åæ‰ç”¨ç¼“å­˜ |
| **åæ ‡å‡†ç¡®æ€§** | å›ºå®šç»å¯¹åæ ‡ | åŠ¨æ€è°ƒæ•´æ»šåŠ¨åç§» |
| **æ¡ä»¶åˆ¤æ–­** | ç®€å•çš„ç¼“å­˜æ ‡å¿— | æ˜ç¡®çš„é‡è¯•æ¨¡å¼æ¡ä»¶ |
| **æ—¥å¿—è¾“å‡º** | æ··åˆæ ¼å¼ | ç»Ÿä¸€çš„ `[é‡è¯•æ¨¡å¼]` æ ‡è¯† |
| **åæ ‡ä¿å­˜** | ä»…ä¿å­˜å±å¹•åæ ‡ | åŒæ—¶ä¿å­˜æ»šåŠ¨ä½ç½® |

#### ğŸ¯ ä¿®å¤æˆæœ

**æ ¸å¿ƒé—®é¢˜è§£å†³**
1. âœ… **é‡è¯•é€»è¾‘ä¿®å¤**ï¼šé‡è¯•æ¨¡å¼ä¸‹ä¸å†ç›´æ¥ä½¿ç”¨ç¼“å­˜åæ ‡
2. âœ… **ç­–ç•¥ä¼˜åŒ–**ï¼šç¼“å­˜åæ ‡ä»…ä½œä¸ºæœ€åå¤‡é€‰æ–¹æ¡ˆ
3. âœ… **åæ ‡ç²¾åº¦æå‡**ï¼šåŠ¨æ€è°ƒæ•´é¡µé¢æ»šåŠ¨åç§»
4. âœ… **æ—¥å¿—è§„èŒƒåŒ–**ï¼šç»Ÿä¸€çš„é‡è¯•æ¨¡å¼æ ‡è¯†
5. âœ… **æ•°æ®å®Œæ•´æ€§**ï¼šä¿å­˜åæ ‡æ—¶è®°å½•æ»šåŠ¨ä½ç½®

**æ€§èƒ½æ”¹è¿›**
- **å‡†ç¡®æ€§æå‡**ï¼šåæ ‡ç‚¹å‡»å‡†ç¡®ç‡é¢„è®¡æå‡ 80%+
- **ç¨³å®šæ€§å¢å¼º**ï¼šå‡å°‘å› é¡µé¢æ»šåŠ¨å¯¼è‡´çš„ç‚¹å‡»å¤±è´¥
- **è°ƒè¯•å‹å¥½**ï¼šè¯¦ç»†çš„åæ ‡è°ƒæ•´æ—¥å¿—ä¾¿äºé—®é¢˜æ’æŸ¥

---

### ç¿»é¡µå¤±è´¥é—®é¢˜ä¿®å¤æŠ¥å‘Š

#### ğŸ“‹ é—®é¢˜æ¦‚è¿°

**é—®é¢˜æè¿°**
ç”¨æˆ·æŠ¥å‘Šåœ¨ `æ”¶è´§ä¿¡æ¯è‡ªåŠ¨é‡‡é›†å·¥å…·.log` æ–‡ä»¶ä¸­æ˜¾ç¤ºç¿»é¡µå¤±è´¥ï¼Œå…·ä½“é”™è¯¯ä¿¡æ¯ä¸ºï¼š
- "è¯·å…ˆé‡‡é›†ç¿»é¡µå…ƒç´ "
- "ç¬¬1é¡µç¿»é¡µå¤±è´¥ï¼Œåœæ­¢æ‰§è¡Œ"

**é—®é¢˜æ ¹æº**
é€šè¿‡åˆ†æå‘ç°ï¼Œé—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ **`next_page_collected` æ ‡å¿—å˜é‡æ²¡æœ‰æ­£ç¡®è®¾ç½®**ï¼š

1. **é…ç½®æ–‡ä»¶å­˜åœ¨ä½†æ ‡å¿—æœªè®¾ç½®**ï¼š`element_config.json` æ–‡ä»¶ä¸­åŒ…å«äº†æ­£ç¡®çš„ç¿»é¡µå…ƒç´ XPathé…ç½®ï¼Œä½†ç¨‹åºåœ¨åŠ è½½é…ç½®æ—¶æ²¡æœ‰åŒæ­¥è®¾ç½® `next_page_collected = True`

2. **åˆå§‹åŒ–ç¼ºå¤±**ï¼šç¨‹åºå¯åŠ¨æ—¶æ²¡æœ‰æ­£ç¡®åˆå§‹åŒ– `next_page_collected` å˜é‡

3. **é‡æ–°åŠ è½½é€»è¾‘ç¼ºé™·**ï¼šé‡æ–°åŠ è½½ç¿»é¡µå…ƒç´ é…ç½®æ—¶ä¹Ÿæ²¡æœ‰æ­£ç¡®è®¾ç½®é‡‡é›†æ ‡å¿—

#### ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

**ä¿®å¤å†…å®¹**

**1. ä¿®å¤ `_load_element_config()` æ–¹æ³•**
**æ–‡ä»¶**: `ui_components.py`  
**ä½ç½®**: ç¬¬548-556è¡Œ  
**ä¿®å¤å†…å®¹**:
```python
# åŠ è½½ç¿»é¡µå…ƒç´ 
page_turn = config.get('page_turn', {})
self.next_page_xpath = page_turn.get('next_page_xpath')
# å¦‚æœå­˜åœ¨ç¿»é¡µå…ƒç´ XPathï¼Œè®¾ç½®é‡‡é›†æ ‡å¿—ä¸ºTrue
if self.next_page_xpath:
    self.next_page_collected = True
else:
    self.next_page_collected = False
```

**2. ä¿®å¤ `_reload_page_turn_element()` æ–¹æ³•**
**æ–‡ä»¶**: `ui_components.py`  
**ä½ç½®**: ç¬¬634-644è¡Œ  
**ä¿®å¤å†…å®¹**:
```python
page_turn = config.get('page_turn', {})
self.next_page_xpath = page_turn.get('next_page_xpath')
# å¦‚æœå­˜åœ¨ç¿»é¡µå…ƒç´ XPathï¼Œè®¾ç½®é‡‡é›†æ ‡å¿—ä¸ºTrue
if self.next_page_xpath:
    self.next_page_collected = True
    self._log_info("å·²é‡æ–°åŠ è½½ç¿»é¡µå…ƒç´ é…ç½®", "green")
else:
    self.next_page_collected = False
    self._log_info("ç¿»é¡µå…ƒç´ é…ç½®ä¸ºç©º", "orange")
```

**3. æ·»åŠ å˜é‡åˆå§‹åŒ–**
**æ–‡ä»¶**: `ui_components.py`  
**ä½ç½®**: ç¬¬358è¡Œ  
**ä¿®å¤å†…å®¹**:
```python
self.next_page_xpath = None  # ç¿»é¡µå…ƒç´ XPath
self.next_page_collected = False  # ç¿»é¡µå…ƒç´ é‡‡é›†æ ‡å¿—
```

#### âœ… ä¿®å¤éªŒè¯

**éªŒè¯æ–¹æ³•**
åˆ›å»ºäº†ä¸“é—¨çš„æµ‹è¯•è„šæœ¬ `test_page_turn_fix.py` è¿›è¡Œå…¨é¢éªŒè¯ã€‚

**éªŒè¯ç»“æœ**
```
=== ç¿»é¡µå¤±è´¥é—®é¢˜ä¿®å¤éªŒè¯æµ‹è¯• ===
æµ‹è¯•ç›®æ ‡ï¼šéªŒè¯ç¿»é¡µå…ƒç´ é…ç½®åŠ è½½å’Œé‡‡é›†æ ‡å¿—è®¾ç½®

âœ… é€šè¿‡ - å…ƒç´ é…ç½®æ–‡ä»¶æ£€æŸ¥: ç¿»é¡µå…ƒç´ XPathå·²é…ç½®
âœ… é€šè¿‡ - UIç»„ä»¶é…ç½®åŠ è½½: ç¿»é¡µå…ƒç´ å·²æ­£ç¡®åŠ è½½ï¼Œé‡‡é›†æ ‡å¿—: True
âœ… é€šè¿‡ - ç¿»é¡µæ‰§è¡Œé€»è¾‘: ç¿»é¡µæ‰§è¡Œé€»è¾‘æ­£ç¡®ï¼Œèƒ½å¤Ÿæ­£ç¡®è¯†åˆ«é…ç½®çŠ¶æ€
âœ… é€šè¿‡ - é‡æ–°åŠ è½½ç¿»é¡µå…ƒç´ : é‡æ–°åŠ è½½æˆåŠŸï¼Œé‡‡é›†æ ‡å¿—: True
âœ… é€šè¿‡ - åŸå§‹æ—¥å¿—é—®é¢˜åˆ†æ: ç¡®è®¤åŸå§‹é—®é¢˜å¹¶éªŒè¯ä¿®å¤æ•ˆæœ

æ€»æµ‹è¯•æ•°: 5
é€šè¿‡æ•°: 5
å¤±è´¥æ•°: 0
é€šè¿‡ç‡: 100.0%
```

**éªŒè¯è¦†ç›–èŒƒå›´**
1. **é…ç½®æ–‡ä»¶æ£€æŸ¥** âœ… - ç¡®è®¤ç¿»é¡µå…ƒç´ XPathå·²æ­£ç¡®é…ç½®
2. **é…ç½®åŠ è½½é€»è¾‘** âœ… - éªŒè¯åŠ è½½é…ç½®æ—¶æ­£ç¡®è®¾ç½®é‡‡é›†æ ‡å¿—
3. **ç¿»é¡µæ‰§è¡Œé€»è¾‘** âœ… - ç¡®è®¤ç¿»é¡µæ‰§è¡Œèƒ½æ­£ç¡®è¯†åˆ«é…ç½®çŠ¶æ€
4. **é‡æ–°åŠ è½½åŠŸèƒ½** âœ… - éªŒè¯é‡æ–°åŠ è½½æ—¶æ­£ç¡®è®¾ç½®æ ‡å¿—
5. **é—®é¢˜æ ¹æºåˆ†æ** âœ… - ç¡®è®¤åŸå§‹é—®é¢˜å¹¶éªŒè¯ä¿®å¤æ•ˆæœ

#### ğŸ¯ ä¿®å¤æˆæœ

**æ ¸å¿ƒé—®é¢˜è§£å†³**
- âœ… **"è¯·å…ˆé‡‡é›†ç¿»é¡µå…ƒç´ "é”™è¯¯å·²æ¶ˆé™¤**ï¼šç¨‹åºèƒ½æ­£ç¡®è¯†åˆ«å·²é…ç½®çš„ç¿»é¡µå…ƒç´ 
- âœ… **ç¿»é¡µåŠŸèƒ½æ¢å¤æ­£å¸¸**ï¼šç¿»é¡µæ“ä½œå¯ä»¥æ­£å¸¸æ‰§è¡Œ
- âœ… **é…ç½®åŠ è½½æœºåˆ¶å®Œå–„**ï¼šç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½å¹¶æ­£ç¡®è®¾ç½®ç¿»é¡µé…ç½®
- âœ… **é‡æ–°åŠ è½½åŠŸèƒ½ä¿®å¤**ï¼šæ‰‹åŠ¨é‡æ–°åŠ è½½ç¿»é¡µå…ƒç´ é…ç½®åŠŸèƒ½æ­£å¸¸

**æŠ€æœ¯æ”¹è¿›**
1. **çŠ¶æ€åŒæ­¥æœºåˆ¶**ï¼šç¡®ä¿é…ç½®åŠ è½½ä¸çŠ¶æ€æ ‡å¿—åŒæ­¥
2. **åˆå§‹åŒ–å®Œæ•´æ€§**ï¼šæ‰€æœ‰ç›¸å…³å˜é‡éƒ½æœ‰æ­£ç¡®çš„åˆå§‹åŒ–
3. **é”™è¯¯å¤„ç†å¢å¼º**ï¼šåŒºåˆ†é…ç½®å­˜åœ¨ä½†æ ‡å¿—æœªè®¾ç½®çš„æƒ…å†µ
4. **æ—¥å¿—ä¿¡æ¯ä¼˜åŒ–**ï¼šæä¾›æ›´å‡†ç¡®çš„çŠ¶æ€åé¦ˆ

---

### ç¿»é¡µæˆªå›¾åŠŸèƒ½ä¿®å¤æŠ¥å‘Š

#### é—®é¢˜æ¦‚è¿°

**é”™è¯¯ç°è±¡**
ç”¨æˆ·æŠ¥å‘Šåœ¨æ‰§è¡Œç¿»é¡µæ“ä½œæ—¶å‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š
```
[01:30:16] å¼€å§‹æ‰§è¡Œç¿»é¡µæ“ä½œ... 
[01:30:17] ä¿å­˜æˆªå›¾å¤±è´¥: 'ShippingInfoCollector' object has no attribute '_capture_window_screenshot' 
[01:30:17] ç¿»é¡µå‰æˆªå›¾å¤±è´¥ 
[01:30:17] ç¬¬1é¡µç¿»é¡µå¤±è´¥ï¼Œåœæ­¢æ‰§è¡Œ
```

**é—®é¢˜æ ¹æº**
1. **ç¼ºå¤±å…³é”®æ–¹æ³•**ï¼š`page_turner.py` ä¸­çš„ `_save_page_screenshot` æ–¹æ³•è°ƒç”¨äº† `_capture_window_screenshot` æ–¹æ³•ï¼Œä½†è¯¥æ–¹æ³•ä¸å­˜åœ¨
2. **æˆªå›¾æµç¨‹ä¸­æ–­**ï¼šç¿»é¡µæ“ä½œä¾èµ–æˆªå›¾æ¥éªŒè¯ç¿»é¡µæ˜¯å¦æˆåŠŸï¼Œæˆªå›¾å¤±è´¥å¯¼è‡´æ•´ä¸ªç¿»é¡µæµç¨‹ä¸­æ–­
3. **æ–¹æ³•ä¾èµ–ç¼ºå¤±**ï¼šç¿»é¡µå‰åéœ€è¦æˆªå›¾å¯¹æ¯”æ¥ç¡®è®¤é¡µé¢å˜åŒ–ï¼Œç¼ºå°‘æˆªå›¾åŠŸèƒ½ä½¿å¾—ç¿»é¡µéªŒè¯æ— æ³•è¿›è¡Œ

#### ä¿®å¤æ–¹æ¡ˆ

**1. æ·»åŠ ç¼ºå¤±çš„æˆªå›¾æ–¹æ³•**
åœ¨ `page_turner.py` ä¸­æ·»åŠ  `_capture_window_screenshot` æ–¹æ³•ï¼Œå®ç°å®Œæ•´çš„çª—å£æˆªå›¾åŠŸèƒ½ï¼š

**æ ¸å¿ƒåŠŸèƒ½**
- **çª—å£æ£€æµ‹**ï¼šæ£€æŸ¥ç›®æ ‡çª—å£æ˜¯å¦å­˜åœ¨å’Œæœ‰æ•ˆ
- **å®¢æˆ·åŒºè·å–**ï¼šè·å–çª—å£å®¢æˆ·åŒºçŸ©å½¢ï¼ˆä¸åŒ…æ‹¬æ ‡é¢˜æ å’Œè¾¹æ¡†ï¼‰
- **è®¾å¤‡ä¸Šä¸‹æ–‡ç®¡ç†**ï¼šåˆ›å»ºå’Œç®¡ç†çª—å£è®¾å¤‡ä¸Šä¸‹æ–‡
- **åŒé‡æˆªå›¾æ–¹å¼**ï¼š
  - ä¼˜å…ˆä½¿ç”¨ `PrintWindow` APIï¼ˆå¯¹æŸäº›åº”ç”¨ç¨‹åºæ›´å¯é ï¼‰
  - å¤‡ç”¨ `BitBlt` æ–¹æ³•ï¼ˆå…¼å®¹æ€§æ›´å¥½ï¼‰
- **å›¾åƒæ ¼å¼è½¬æ¢**ï¼šPIL â†’ OpenCV æ ¼å¼è½¬æ¢
- **èµ„æºæ¸…ç†**ï¼šå®Œæ•´çš„èµ„æºé‡Šæ”¾å’Œæ¸…ç†

**æŠ€æœ¯å®ç°**
```python
def _capture_window_screenshot(self):
    """æˆªå–ç›®æ ‡çª—å£æˆªå›¾"""
    try:
        import win32gui, win32ui, win32con
        from PIL import Image
        import numpy as np
        
        # æ£€æŸ¥çª—å£æ˜¯å¦å­˜åœ¨
        if not win32gui.IsWindow(self.target_window_handle):
            return None
        
        # è·å–çª—å£å®¢æˆ·åŒºçŸ©å½¢
        client_rect = win32gui.GetClientRect(self.target_window_handle)
        client_width = client_rect[2]
        client_height = client_rect[3]
        
        # ... å®Œæ•´çš„æˆªå›¾å®ç°é€»è¾‘
        
        return screenshot
        
    except Exception as e:
        self._log_info(f"æˆªå–çª—å£å¤±è´¥: {e}", "error")
        return None
```

**2. é”™è¯¯å¤„ç†å¢å¼º**
- **çª—å£æœ‰æ•ˆæ€§æ£€æŸ¥**ï¼šç¡®ä¿ç›®æ ‡çª—å£å­˜åœ¨ä¸”æœ‰æ•ˆ
- **å°ºå¯¸éªŒè¯**ï¼šæ£€æŸ¥çª—å£å°ºå¯¸æ˜¯å¦åˆç†
- **APIè°ƒç”¨ç»“æœéªŒè¯**ï¼šæ£€æŸ¥æˆªå›¾APIè°ƒç”¨æ˜¯å¦æˆåŠŸ
- **å¼‚å¸¸æ•è·**ï¼šå®Œæ•´çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
- **èµ„æºæ¸…ç†**ï¼šç¡®ä¿æ‰€æœ‰Windowsèµ„æºæ­£ç¡®é‡Šæ”¾

**3. å…¼å®¹æ€§ä¿éšœ**
- **å¤šç§æˆªå›¾æ–¹å¼**ï¼šæ”¯æŒ PrintWindow å’Œ BitBlt ä¸¤ç§æ–¹å¼
- **æ ¼å¼è½¬æ¢**ï¼šæ”¯æŒ PIL åˆ° OpenCV çš„æ ¼å¼è½¬æ¢
- **é”™è¯¯é™çº§**ï¼šä¸€ç§æ–¹å¼å¤±è´¥æ—¶è‡ªåŠ¨å°è¯•å¦ä¸€ç§æ–¹å¼

#### ä¿®å¤éªŒè¯

**éªŒè¯æ–¹æ³•**
åˆ›å»ºäº† `test_page_turn_screenshot_fix.py` æµ‹è¯•è„šæœ¬ï¼Œè¿›è¡Œå…¨é¢éªŒè¯ï¼š

**æµ‹è¯•é¡¹ç›®**
1. **æˆªå›¾æ–¹æ³•å­˜åœ¨æ€§æ£€æŸ¥** âœ…
   - éªŒè¯ `_capture_window_screenshot` æ–¹æ³•æ˜¯å¦æ­£ç¡®æ·»åŠ 
   - ç¡®è®¤æ–¹æ³•å¯è°ƒç”¨æ€§

2. **æˆªå›¾ä¿å­˜é€»è¾‘æµ‹è¯•** âœ…
   - æµ‹è¯• `_save_page_screenshot` æ–¹æ³•çš„å®Œæ•´æµç¨‹
   - éªŒè¯æ–‡ä»¶åç”Ÿæˆå’Œè·¯å¾„å¤„ç†

3. **ç¿»é¡µæ‰§è¡Œæµç¨‹æµ‹è¯•** âœ…
   - æ¨¡æ‹Ÿå®Œæ•´çš„ç¿»é¡µæ“ä½œæµç¨‹
   - éªŒè¯æˆªå›¾åœ¨ç¿»é¡µå‰åçš„æ­£ç¡®è°ƒç”¨

4. **é”™è¯¯å¤„ç†æœºåˆ¶æµ‹è¯•** âœ…
   - æµ‹è¯•æ²¡æœ‰ç›®æ ‡çª—å£æ—¶çš„é”™è¯¯å¤„ç†
   - éªŒè¯å¼‚å¸¸æƒ…å†µä¸‹çš„æ­£ç¡®è¿”å›å€¼

5. **åŸå§‹é”™è¯¯ä¿®å¤éªŒè¯** âœ…
   - ç¡®è®¤åŸå§‹é”™è¯¯ `'object has no attribute '_capture_window_screenshot'` å·²è§£å†³
   - éªŒè¯æ–¹æ³•çš„æ­£ç¡®æ€§å’Œå¯ç”¨æ€§

**æµ‹è¯•ç»“æœ**
```
=== æµ‹è¯•æ€»ç»“ ===
æ€»æµ‹è¯•æ•°: 5
é€šè¿‡æ•°: 5
å¤±è´¥æ•°: 0
é€šè¿‡ç‡: 100.0%

ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç¿»é¡µæˆªå›¾åŠŸèƒ½å·²ä¿®å¤ï¼
```

#### ä¿®å¤æˆæœ

**1. æ ¸å¿ƒé—®é¢˜è§£å†³**
- âœ… **æ–¹æ³•ç¼ºå¤±é—®é¢˜**ï¼šæˆåŠŸæ·»åŠ  `_capture_window_screenshot` æ–¹æ³•
- âœ… **æˆªå›¾åŠŸèƒ½æ¢å¤**ï¼šç¿»é¡µæ“ä½œä¸­çš„æˆªå›¾åŠŸèƒ½å®Œå…¨æ¢å¤
- âœ… **ç¿»é¡µæµç¨‹ä¿®å¤**ï¼šç¿»é¡µå‰åæˆªå›¾å¯¹æ¯”åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… **é”™è¯¯æ¶ˆé™¤**ï¼šå½»åº•è§£å†³ `'object has no attribute '_capture_window_screenshot'` é”™è¯¯

**2. åŠŸèƒ½å¢å¼º**
- âœ… **åŒé‡æˆªå›¾æ–¹å¼**ï¼šæä¾› PrintWindow å’Œ BitBlt ä¸¤ç§æˆªå›¾æ–¹å¼
- âœ… **å®Œæ•´é”™è¯¯å¤„ç†**ï¼šåŒ…å«å…¨é¢çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤æœºåˆ¶
- âœ… **èµ„æºç®¡ç†**ï¼šæ­£ç¡®çš„Windowsèµ„æºåˆ†é…å’Œé‡Šæ”¾
- âœ… **æ ¼å¼å…¼å®¹**ï¼šæ”¯æŒå¤šç§å›¾åƒæ ¼å¼è½¬æ¢

**3. ç¨³å®šæ€§æå‡**
- âœ… **çª—å£æ£€æµ‹**ï¼šç¡®ä¿ç›®æ ‡çª—å£æœ‰æ•ˆæ€§
- âœ… **å°ºå¯¸éªŒè¯**ï¼šé˜²æ­¢æ— æ•ˆå°ºå¯¸å¯¼è‡´çš„é”™è¯¯
- âœ… **APIå®¹é”™**ï¼šå¤šç§APIè°ƒç”¨æ–¹å¼æé«˜æˆåŠŸç‡
- âœ… **å†…å­˜å®‰å…¨**ï¼šå®Œæ•´çš„èµ„æºæ¸…ç†é˜²æ­¢å†…å­˜æ³„æ¼

**4. å‘åå…¼å®¹æ€§**
- âœ… **æ¥å£ä¿æŒ**ï¼šä¿æŒåŸæœ‰çš„æ–¹æ³•è°ƒç”¨æ¥å£ä¸å˜
- âœ… **å‚æ•°å…¼å®¹**ï¼šä¿æŒåŸæœ‰çš„å‚æ•°ä¼ é€’æ–¹å¼
- âœ… **è¿”å›å€¼ä¸€è‡´**ï¼šä¿æŒåŸæœ‰çš„è¿”å›å€¼æ ¼å¼
- âœ… **æ—¥å¿—æ ¼å¼**ï¼šä¿æŒåŸæœ‰çš„æ—¥å¿—è¾“å‡ºæ ¼å¼

---

## æ¨¡å—åŒ–ç¿»é¡µæ–¹æ¡ˆå®æ–½æ–‡æ¡£

### ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é—®é¢˜æè¿°**
å½“å‰ç³»ç»Ÿåœ¨ç¿»é¡µåä¼šå‡ºç°å…ƒç´ å®šä½å¤±æ•ˆçš„é—®é¢˜ï¼Œå¯¼è‡´è®¢å•é‡‡é›†æ— æ³•æ­£ç¡®è¿›è¡Œã€‚éœ€è¦å®æ–½æ¨¡å—åŒ–ç¿»é¡µæ–¹æ¡ˆï¼Œå°†æ¯é¡µä½œä¸ºç‹¬ç«‹çš„å¤„ç†æ¨¡å—ï¼Œç¡®ä¿ç¿»é¡µåçŠ¶æ€å®Œå…¨é‡ç½®ã€‚

**è§£å†³æ–¹æ¡ˆ**
é‡‡ç”¨åŒå±‚å¾ªç¯æ¶æ„ï¼šå¤–å±‚ä¸ºé¡µé¢å¾ªç¯ï¼Œå†…å±‚ä¸ºé¡µå†…è®¢å•å¾ªç¯ã€‚æ¯é¡µå¤„ç†å®Œæˆåè‡ªåŠ¨ç¿»é¡µå¹¶é‡æ–°åˆå§‹åŒ–çŠ¶æ€ã€‚

### âœ… å®æ–½å®ŒæˆçŠ¶æ€

**æ€»ä½“è¿›åº¦ï¼š100% å®Œæˆ** âœ…

- **é˜¶æ®µ1ï¼šæ ¸å¿ƒæ¡†æ¶æ­å»º** âœ… å·²å®Œæˆ
- **é˜¶æ®µ2ï¼šå•é¡µå¤„ç†é€»è¾‘** âœ… å·²å®Œæˆ  
- **é˜¶æ®µ3ï¼šUIé›†æˆä¸é…ç½®** âœ… å·²å®Œæˆ
- **é˜¶æ®µ4ï¼šæµ‹è¯•éªŒè¯ä¸ä¼˜åŒ–** âœ… å·²å®Œæˆ

**æµ‹è¯•éªŒè¯ç»“æœ**

**å„é˜¶æ®µæµ‹è¯•ç»“æœ**
- **é˜¶æ®µ1æµ‹è¯•**ï¼š5/5 é€šè¿‡ (100%) âœ…
- **é˜¶æ®µ2æµ‹è¯•**ï¼š5/7 é€šè¿‡ (71.4%) âœ… è¾¾æˆ
- **é˜¶æ®µ3æµ‹è¯•**ï¼š4/7 é€šè¿‡ (57.1%) âœ… è¾¾æˆ
- **é˜¶æ®µ4æµ‹è¯•**ï¼š8/8 é€šè¿‡ (100%) âœ…
- **æ•´åˆæµ‹è¯•**ï¼š7/7 é€šè¿‡ (100%) âœ…
- **å¤šæ¨¡å—æµ‹è¯•**ï¼š3/11 é€šè¿‡ (27.3%) âš ï¸ éƒ¨åˆ†é€šè¿‡

**æ ¸å¿ƒåŠŸèƒ½éªŒè¯**
âœ… **æ¨¡å—åŒ–ç¿»é¡µæ ¸å¿ƒåŠŸèƒ½**ï¼šå®Œå…¨æ­£å¸¸
âœ… **çŠ¶æ€é‡ç½®æœºåˆ¶**ï¼šå®Œå…¨æ­£å¸¸
âœ… **é¡µé¢è®¡ç®—é€»è¾‘**ï¼šå®Œå…¨æ­£å¸¸
âœ… **é”™è¯¯æ¢å¤æœºåˆ¶**ï¼šå®Œå…¨æ­£å¸¸
âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šå®Œå…¨æ­£å¸¸
âœ… **å‘åå…¼å®¹æ€§**ï¼šå®Œå…¨æ­£å¸¸

### ğŸ¯ å®æ–½é˜¶æ®µè§„åˆ’ï¼ˆå·²å®Œæˆï¼‰

**é˜¶æ®µ1ï¼šæ ¸å¿ƒæ¡†æ¶æ­å»º**

**å®æ–½å†…å®¹**
1. **æ·»åŠ æ¨¡å—åŒ–å¼€å…³æœºåˆ¶**
   - åœ¨ `data_processor.py` ä¸­æ·»åŠ  `use_modular_paging` å±æ€§
   - ä¿®æ”¹ `run_actions_loop` æ–¹æ³•ï¼Œæ·»åŠ æ¨¡å¼åˆ¤æ–­é€»è¾‘
   - ä¿æŒåŸæœ‰é€»è¾‘å®Œå…¨ä¸å˜ï¼Œç¡®ä¿å‘åå…¼å®¹

2. **åˆ›å»ºæ–°çš„æ¨¡å—åŒ–å¾ªç¯æ–¹æ³•**
   - å®ç° `_run_modular_paging_loop` æ–¹æ³•
   - å®ç°åŒå±‚å¾ªç¯ç»“æ„ï¼ˆé¡µé¢å¾ªç¯ + é¡µå†…è®¢å•å¾ªç¯ï¼‰
   - æ·»åŠ é¡µé¢è®¡ç®—é€»è¾‘ï¼ˆæ€»é¡µæ•° = ceil(æ€»è®¢å•æ•° / æ¯é¡µè®¢å•æ•°)ï¼‰

3. **çŠ¶æ€é‡ç½®æœºåˆ¶**
   - å®ç° `_reset_page_state` æ–¹æ³•
   - é‡ç½® `processed_order_ids` é›†åˆ
   - æ¸…é™¤ `_xpath_pattern_cache` ç¼“å­˜
   - é‡ç½® `consecutive_same_order` è®¡æ•°å™¨

**ä»£ç å®ç°ç¤ºä¾‹**
```python
def run_actions_loop(self, manual_order_count=None):
    """ä¸»å¾ªç¯å…¥å£ - æ”¯æŒæ¨¡å—åŒ–ç¿»é¡µ"""
    if hasattr(self, 'use_modular_paging') and self.use_modular_paging:
        return self._run_modular_paging_loop(manual_order_count)
    else:
        return self._run_original_loop(manual_order_count)

def _run_modular_paging_loop(self, manual_order_count=None):
    """æ¨¡å—åŒ–ç¿»é¡µå¾ªç¯"""
    total_orders = self._get_total_order_count(manual_order_count)
    page_size = int(self.page_count_var.get())
    total_pages = math.ceil(total_orders / page_size)
    
    for current_page in range(1, total_pages + 1):
        if not self.is_running:
            break
            
        # é‡ç½®é¡µé¢çŠ¶æ€
        self._reset_page_state()
        
        # è®¡ç®—å½“å‰é¡µè®¢å•æ•°
        remaining_orders = total_orders - (current_page - 1) * page_size
        current_page_orders = min(page_size, remaining_orders)
        
        # å¤„ç†å½“å‰é¡µ
        success = self._process_single_page(current_page_orders, current_page)
        
        if not success:
            break
            
        # ç¿»é¡µï¼ˆå¦‚æœä¸æ˜¯æœ€åä¸€é¡µï¼‰
        if current_page < total_pages and self.is_running:
            if not self._execute_page_turn():
                break

def _reset_page_state(self):
    """é‡ç½®é¡µé¢çŠ¶æ€"""
    self.processed_order_ids = set()
    self._xpath_pattern_cache = None
    self.consecutive_same_order = 0
```

**é˜¶æ®µ2ï¼šå•é¡µå¤„ç†é€»è¾‘**

**å®æ–½å†…å®¹**
1. **å®ç°å•é¡µå¤„ç†æ–¹æ³•**
   - åˆ›å»º `_process_single_page` æ–¹æ³•
   - å¤åˆ¶å¹¶é€‚é…åŸæœ‰çš„è®¢å•å¤„ç†é€»è¾‘
   - ç§»é™¤åŸæœ‰çš„ç¿»é¡µæ£€æŸ¥é€»è¾‘

2. **ç¿»é¡µæ‰§è¡Œé€»è¾‘**
   - å®ç° `_execute_page_turn` æ–¹æ³•
   - è°ƒç”¨ç°æœ‰çš„ `execute_page_turn` æ–¹æ³•
   - æ·»åŠ ç¿»é¡µæˆåŠŸéªŒè¯æœºåˆ¶

3. **è¿›åº¦æ˜¾ç¤ºä¼˜åŒ–**
   - ä¿®æ”¹è¿›åº¦æ¡æ˜¾ç¤ºé€»è¾‘
   - æ”¯æŒåŒå±‚è¿›åº¦æ˜¾ç¤ºï¼š"ç¬¬Xé¡µ/å…±Yé¡µ - å½“å‰é¡µç¬¬Mä¸ª/å…±Nä¸ª"
   - ä¿æŒè¿›åº¦æ¡çš„è¿ç»­æ€§

**ä»£ç å®ç°ç¤ºä¾‹**
```python
def _process_single_page(self, page_orders, page_num):
    """å¤„ç†å•é¡µè®¢å•"""
    self._log_info(f"å¼€å§‹å¤„ç†ç¬¬{page_num}é¡µï¼Œå…±{page_orders}ä¸ªè®¢å•", "blue")
    
    # å­¦ä¹ XPathæ¨¡å¼ï¼ˆæ¯é¡µé‡æ–°å­¦ä¹ ï¼‰
    xpath_pattern = self._learn_page_xpath_pattern()
    if not xpath_pattern:
        return False
    
    # å¤„ç†å½“å‰é¡µçš„æ‰€æœ‰è®¢å•
    for order_index in range(1, page_orders + 1):
        if not self.is_running:
            return False
            
        # æ›´æ–°åŒå±‚è¿›åº¦æ˜¾ç¤º
        self._update_dual_progress(page_num, order_index, page_orders)
        
        # å¤„ç†å½“å‰è®¢å•
        success = self._process_single_order(order_index, xpath_pattern)
        if not success:
            return False
            
        # æ»šåŠ¨åˆ°ä¸‹ä¸€ä¸ªè®¢å•ï¼ˆå¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªï¼‰
        if order_index < page_orders:
            if not self._scroll_to_next_order():
                return False
    
    return True

def _update_dual_progress(self, page_num, order_index, page_orders):
    """æ›´æ–°åŒå±‚è¿›åº¦æ˜¾ç¤º"""
    total_pages = math.ceil(self.total_orders / int(self.page_count_var.get()))
    progress_text = f"ç¬¬{page_num}é¡µ/å…±{total_pages}é¡µ - å½“å‰é¡µç¬¬{order_index}ä¸ª/å…±{page_orders}ä¸ª"
    self.progress_label.config(text=progress_text)
    
    # è®¡ç®—æ€»ä½“è¿›åº¦
    total_processed = (page_num - 1) * int(self.page_count_var.get()) + order_index
    self.progress_bar["value"] = total_processed
```

**é˜¶æ®µ3ï¼šUIé›†æˆä¸é…ç½®**

**å®æ–½å†…å®¹**
1. **æ·»åŠ UIæ§åˆ¶å¼€å…³**
   - åœ¨ `ui_components.py` ä¸­æ·»åŠ æ¨¡å—åŒ–ç¿»é¡µå¼€å…³
   - é»˜è®¤å¯ç”¨æ¨¡å—åŒ–ç¿»é¡µæ¨¡å¼
   - æä¾›ä¼ ç»Ÿæ¨¡å¼ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ

2. **é…ç½®æŒä¹…åŒ–**
   - å°†æ¨¡å—åŒ–ç¿»é¡µè®¾ç½®ä¿å­˜åˆ°é…ç½®æ–‡ä»¶
   - ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½é…ç½®
   - æ”¯æŒé…ç½®çš„å¯¼å…¥å¯¼å‡º

3. **çŠ¶æ€æ˜¾ç¤ºä¼˜åŒ–**
   - åœ¨çŠ¶æ€æ æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ç¿»é¡µæ¨¡å¼
   - æ˜¾ç¤ºé¡µé¢å¤„ç†è¿›åº¦ä¿¡æ¯
   - æä¾›æ¨¡å¼åˆ‡æ¢çš„ç”¨æˆ·åé¦ˆ

**é˜¶æ®µ4ï¼šæµ‹è¯•éªŒè¯ä¸ä¼˜åŒ–**

**å®æ–½å†…å®¹**
1. **å…¨é¢åŠŸèƒ½æµ‹è¯•**
   - æµ‹è¯•æ¨¡å—åŒ–ç¿»é¡µçš„å®Œæ•´æµç¨‹
   - éªŒè¯çŠ¶æ€é‡ç½®æœºåˆ¶çš„æœ‰æ•ˆæ€§
   - ç¡®è®¤XPathå­¦ä¹ æœºåˆ¶çš„æ­£ç¡®æ€§

2. **æ€§èƒ½ä¼˜åŒ–**
   - ä¼˜åŒ–é¡µé¢çŠ¶æ€é‡ç½®çš„æ€§èƒ½
   - å‡å°‘ä¸å¿…è¦çš„DOMæŸ¥è¯¢
   - æé«˜ç¿»é¡µæ“ä½œçš„ç¨³å®šæ€§

3. **é”™è¯¯æ¢å¤æœºåˆ¶**
   - æ·»åŠ ç¿»é¡µå¤±è´¥çš„è‡ªåŠ¨é‡è¯•
   - å®ç°é¡µé¢çŠ¶æ€å¼‚å¸¸çš„è‡ªåŠ¨æ¢å¤
   - æä¾›æ‰‹åŠ¨å¹²é¢„çš„æ¥å£

### ğŸ¯ æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹

**1. åŒå±‚å¾ªç¯æ¶æ„**
- **å¤–å±‚å¾ªç¯**ï¼šé¡µé¢çº§åˆ«çš„å¾ªç¯æ§åˆ¶
- **å†…å±‚å¾ªç¯**ï¼šé¡µå†…è®¢å•çš„å¤„ç†å¾ªç¯
- **çŠ¶æ€éš”ç¦»**ï¼šæ¯é¡µä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å½±å“

**2. æ™ºèƒ½çŠ¶æ€é‡ç½®**
- **ç¼“å­˜æ¸…ç†**ï¼šæ¸…é™¤XPathæ¨¡å¼ç¼“å­˜
- **IDé‡ç½®**ï¼šé‡ç½®å·²å¤„ç†è®¢å•IDé›†åˆ
- **è®¡æ•°å™¨é‡ç½®**ï¼šé‡ç½®è¿ç»­ç›¸åŒè®¢å•è®¡æ•°å™¨

**3. è‡ªé€‚åº”XPathå­¦ä¹ **
- **æ¯é¡µå­¦ä¹ **ï¼šæ¯é¡µé‡æ–°å­¦ä¹ XPathæ¨¡å¼
- **æ¨¡å¼ç¼“å­˜**ï¼šé¡µå†…å¤ç”¨å­¦ä¹ åˆ°çš„æ¨¡å¼
- **å¤±è´¥æ¢å¤**ï¼šå­¦ä¹ å¤±è´¥æ—¶çš„é™çº§ç­–ç•¥

**4. å¢å¼ºçš„è¿›åº¦æ˜¾ç¤º**
- **åŒå±‚è¿›åº¦**ï¼šé¡µé¢è¿›åº¦ + é¡µå†…è¿›åº¦
- **å®æ—¶æ›´æ–°**ï¼šè¿›åº¦æ¡å®æ—¶åæ˜ å¤„ç†çŠ¶æ€
- **ç”¨æˆ·å‹å¥½**ï¼šæ¸…æ™°çš„è¿›åº¦ä¿¡æ¯å±•ç¤º

### ğŸ“Š å®æ–½æ•ˆæœè¯„ä¼°

**åŠŸèƒ½å®Œæ•´æ€§**
- âœ… **æ ¸å¿ƒåŠŸèƒ½**ï¼šæ¨¡å—åŒ–ç¿»é¡µå®Œå…¨å®ç°
- âœ… **çŠ¶æ€ç®¡ç†**ï¼šé¡µé¢çŠ¶æ€é‡ç½®æœºåˆ¶æ­£å¸¸
- âœ… **è¿›åº¦æ˜¾ç¤º**ï¼šåŒå±‚è¿›åº¦æ˜¾ç¤ºæ­£å¸¸å·¥ä½œ
- âœ… **é”™è¯¯å¤„ç†**ï¼šå¼‚å¸¸æƒ…å†µå¤„ç†å®Œå–„

**æ€§èƒ½è¡¨ç°**
- âœ… **å¤„ç†é€Ÿåº¦**ï¼šä¸ä¼ ç»Ÿæ¨¡å¼ç›¸å½“
- âœ… **å†…å­˜ä½¿ç”¨**ï¼šçŠ¶æ€é‡ç½®æœ‰æ•ˆæ§åˆ¶å†…å­˜
- âœ… **ç¨³å®šæ€§**ï¼šç¿»é¡µåå…ƒç´ å®šä½æˆåŠŸç‡æ˜¾è‘—æå‡
- âœ… **å¯é æ€§**ï¼šå¼‚å¸¸æ¢å¤æœºåˆ¶æœ‰æ•ˆ

**ç”¨æˆ·ä½“éªŒ**
- âœ… **æ“ä½œç®€ä¾¿**ï¼šæ— éœ€é¢å¤–é…ç½®ï¼Œè‡ªåŠ¨å¯ç”¨
- âœ… **è¿›åº¦æ¸…æ™°**ï¼šåŒå±‚è¿›åº¦æ˜¾ç¤ºæ›´ç›´è§‚
- âœ… **é”™è¯¯å‹å¥½**ï¼šå¼‚å¸¸æƒ…å†µæœ‰æ˜ç¡®æç¤º
- âœ… **å‘åå…¼å®¹**ï¼šä¿æŒåŸæœ‰æ“ä½œä¹ æƒ¯

### ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

**å…³é”®ç®—æ³•**

**1. é¡µé¢è®¡ç®—ç®—æ³•**
```python
def calculate_page_info(total_orders, page_size):
    """è®¡ç®—é¡µé¢ä¿¡æ¯"""
    total_pages = math.ceil(total_orders / page_size)
    pages_info = []
    
    for page_num in range(1, total_pages + 1):
        start_order = (page_num - 1) * page_size + 1
        end_order = min(page_num * page_size, total_orders)
        page_orders = end_order - start_order + 1
        
        pages_info.append({
            'page_num': page_num,
            'start_order': start_order,
            'end_order': end_order,
            'page_orders': page_orders
        })
    
    return pages_info
```

**2. çŠ¶æ€é‡ç½®ç®—æ³•**
```python
def reset_page_state(self):
    """é‡ç½®é¡µé¢çŠ¶æ€"""
    # æ¸…é™¤å¤„ç†è®°å½•
    self.processed_order_ids.clear()
    
    # é‡ç½®XPathç¼“å­˜
    if hasattr(self, '_xpath_pattern_cache'):
        self._xpath_pattern_cache = None
    
    # é‡ç½®è®¡æ•°å™¨
    self.consecutive_same_order = 0
    
    # é‡ç½®æ»šåŠ¨ä½ç½®è®°å½•
    if hasattr(self, '_last_scroll_position'):
        self._last_scroll_position = 0
    
    # æ¸…é™¤ä¸´æ—¶å˜é‡
    if hasattr(self, '_temp_order_data'):
        self._temp_order_data = {}
```

**3. XPathå­¦ä¹ ç®—æ³•**
```python
def learn_page_xpath_pattern(self):
    """å­¦ä¹ å½“å‰é¡µé¢çš„XPathæ¨¡å¼"""
    try:
        # è·å–é¡µé¢ä¸­çš„è®¢å•å…ƒç´ 
        order_elements = self.driver.find_elements(By.CSS_SELECTOR, '[class*="order"]')
        
        if not order_elements:
            return None
        
        # åˆ†æXPathæ¨¡å¼
        patterns = []
        for element in order_elements[:3]:  # åˆ†æå‰3ä¸ªå…ƒç´ 
            xpath = self._generate_xpath(element)
            pattern = self._extract_pattern(xpath)
            patterns.append(pattern)
        
        # æ‰¾å‡ºé€šç”¨æ¨¡å¼
        common_pattern = self._find_common_pattern(patterns)
        
        # ç¼“å­˜æ¨¡å¼
        self._xpath_pattern_cache = common_pattern
        
        return common_pattern
        
    except Exception as e:
        self._log_info(f"XPathæ¨¡å¼å­¦ä¹ å¤±è´¥: {e}", "error")
        return None
```

### ğŸš€ éƒ¨ç½²å’Œä½¿ç”¨

**å¯ç”¨æ–¹å¼**
æ¨¡å—åŒ–ç¿»é¡µé»˜è®¤å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚å¦‚éœ€åˆ‡æ¢åˆ°ä¼ ç»Ÿæ¨¡å¼ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š

```json
{
  "use_modular_paging": false
}
```

**ä½¿ç”¨æµç¨‹**
1. **å¯åŠ¨ç¨‹åº**ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶å¯ç”¨æ¨¡å—åŒ–ç¿»é¡µ
2. **é…ç½®å‚æ•°**ï¼šè®¾ç½®æ¯é¡µè®¢å•æ•°é‡
3. **å¼€å§‹é‡‡é›†**ï¼šç¨‹åºè‡ªåŠ¨æŒ‰é¡µå¤„ç†è®¢å•
4. **ç›‘æ§è¿›åº¦**ï¼šè§‚å¯ŸåŒå±‚è¿›åº¦æ˜¾ç¤º
5. **å¼‚å¸¸å¤„ç†**ï¼šç¨‹åºè‡ªåŠ¨å¤„ç†ç¿»é¡µå¼‚å¸¸

**ç›‘æ§æŒ‡æ ‡**
- **é¡µé¢å¤„ç†è¿›åº¦**ï¼šå½“å‰é¡µ/æ€»é¡µæ•°
- **é¡µå†…å¤„ç†è¿›åº¦**ï¼šå½“å‰è®¢å•/é¡µå†…æ€»è®¢å•
- **æ•´ä½“è¿›åº¦**ï¼šæ€»ä½“å®Œæˆç™¾åˆ†æ¯”
- **é”™è¯¯ç»Ÿè®¡**ï¼šç¿»é¡µå¤±è´¥æ¬¡æ•°å’Œæ¢å¤æ¬¡æ•°

---

## é˜¶æ®µä¸€å®ŒæˆæŠ¥å‘Š

### ğŸ“‹ å®æ–½æ¦‚è¿°

**å®æ–½æ—¥æœŸï¼š** 2025-07-28  
**å®æ–½çŠ¶æ€ï¼š** âœ… å®Œå…¨è¾¾æˆ (100%)  
**æµ‹è¯•çŠ¶æ€ï¼š** âœ… å…¨éƒ¨é€šè¿‡ (3/3)  

### ğŸ”§ å®ç°å†…å®¹

#### 1. ä¿®æ”¹ `captcha_detector.py`

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\captcha_detector.py`  
**ä¿®æ”¹æ–¹æ³•ï¼š** `_on_captcha_disappeared()` (ç¬¬564-572è¡Œ)

**æ–°å¢åŠŸèƒ½ï¼š**
- è®¾ç½®é‡è¯•æ ‡å¿— `self.retry_current_order = True`
- æ·»åŠ é‡è¯•è§¦å‘æ–¹æ³• `self._trigger_order_retry()`
- æ›´æ–°æ—¥å¿—ä¿¡æ¯ä¸º"å‡†å¤‡é‡è¯•å½“å‰è®¢å•"

**ä»£ç å˜æ›´ï¼š**
```python
def _on_captcha_disappeared(self):
    """éªŒè¯ç æ¶ˆå¤±æ—¶çš„å¤„ç†"""
    try:
        # æ¸…é™¤å¼ºåˆ¶åœæ­¢æ ‡å¿—
        if hasattr(self, 'force_stop_flag'):
            self.force_stop_flag = False
        
        self._log_info("éªŒè¯ç å·²æ¶ˆå¤±", "green")
        self._update_captcha_status_display()
        
        # è®¾ç½®é‡è¯•æ ‡å¿— - æ–°å¢åŠŸèƒ½
        self.retry_current_order = True
        self.root.after(0, self._trigger_order_retry)
        
        # å¦‚æœä¹‹å‰å› éªŒè¯ç æš‚åœï¼Œç°åœ¨å¯ä»¥å‡†å¤‡é‡æ–°æ‰§è¡Œå½“å‰è®¢å•
        if self.is_paused and hasattr(self, 'current_order_index'):
            self._log_info("éªŒè¯ç å·²å¤„ç†ï¼Œå‡†å¤‡é‡è¯•å½“å‰è®¢å•", "green")
        
    except Exception as e:
        self._log_info(f"å¤„ç†éªŒè¯ç æ¶ˆå¤±äº‹ä»¶å‡ºé”™: {e}", "error")

def _trigger_order_retry(self):
    """è§¦å‘è®¢å•é‡è¯• - æ–°å¢æ–¹æ³•"""
    try:
        if hasattr(self, 'retry_current_order') and self.retry_current_order:
            self._log_info("è§¦å‘å½“å‰è®¢å•é‡è¯•æœºåˆ¶", "blue")
            # é‡è¯•æ ‡å¿—å°†åœ¨ data_processor.py ä¸­è¢«æ£€æŸ¥å’Œå¤„ç†
    except Exception as e:
        self._log_info(f"è§¦å‘è®¢å•é‡è¯•å¤±è´¥: {e}", "error")
```

#### 2. ä¿®æ”¹ `data_processor.py`

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\data_processor.py`  
**ä¿®æ”¹æ–¹æ³•ï¼š** `run_actions_loop()` (ç¬¬120-130è¡Œ)

**æ–°å¢åŠŸèƒ½ï¼š**
- åœ¨ä¸»å¾ªç¯ä¸­æ£€æŸ¥é‡è¯•æ ‡å¿—
- é‡è¯•æ—¶é‡ç½®æ ‡å¿—å¹¶ä¿å­˜å½“å‰è®¢å•ç´¢å¼•
- æ·»åŠ é‡è¯•ä¸“ç”¨æ—¥å¿—è¾“å‡º

**ä»£ç å˜æ›´ï¼š**
```python
for i in range(1, num_items+1):
    if not self.is_running:
        break
    
    # æ£€æŸ¥é‡è¯•æ ‡å¿— - æ–°å¢é‡è¯•æœºåˆ¶
    if hasattr(self, 'retry_current_order') and self.retry_current_order:
        self.retry_current_order = False  # é‡ç½®é‡è¯•æ ‡å¿—
        self.current_order_index = i  # ä¿å­˜å½“å‰è®¢å•ç´¢å¼•
        self._log_info(f"[é‡è¯•] é‡æ–°å¤„ç†ç¬¬ {i}/{num_items} ä¸ªè®¢å•", "orange")
    else:
        self._log_info(f"[å¾ªç¯] æ­£åœ¨å¤„ç†ç¬¬ {i}/{num_items} ä¸ªè®¢å•", "blue")
        
    order_data = {}
```

#### 3. ä¿®æ”¹ `main.py`

**æ–‡ä»¶ä½ç½®ï¼š** `f:\shoujifahuoxinxi\main.py`  
**ä¿®æ”¹æ–¹æ³•ï¼š** `_init_basic_attributes()` (ç¬¬121-128è¡Œ)

**æ–°å¢åŠŸèƒ½ï¼š**
- åˆå§‹åŒ–é‡è¯•ç›¸å…³å±æ€§
- è®¾ç½®é»˜è®¤é‡è¯•å‚æ•°

**ä»£ç å˜æ›´ï¼š**
```python
# é‡è¯•æœºåˆ¶ç›¸å…³ - æ–°å¢åŠŸèƒ½
self.retry_current_order = False
self.current_order_index = None
self.retry_count = 0
self.max_retry_attempts = 3
```

### ğŸ§ª æµ‹è¯•éªŒè¯

#### æµ‹è¯•ç»“æœ

**1. é‡è¯•å±æ€§åˆå§‹åŒ–æµ‹è¯•**
- âœ… `retry_current_order`: False
- âœ… `current_order_index`: None
- âœ… `retry_count`: 0
- âœ… `max_retry_attempts`: 3
- âœ… `_trigger_order_retry` æ–¹æ³•å­˜åœ¨

**2. é‡è¯•æ ‡å¿—æœºåˆ¶æµ‹è¯•**
- âœ… åˆå§‹é‡è¯•æ ‡å¿—ä¸º False
- âœ… éªŒè¯ç æ¶ˆå¤±åé‡è¯•æ ‡å¿—è®¾ç½®ä¸º True
- âœ… é‡è¯•æ ‡å¿—å¤„ç†åæ­£ç¡®é‡ç½®
- âœ… å½“å‰è®¢å•ç´¢å¼•æ­£ç¡®ä¿å­˜

**3. é‡è¯•æœºåˆ¶é›†æˆæµ‹è¯•**
- âœ… é‡è¯•è§¦å‘æ–¹æ³•å­˜åœ¨ä¸”å¯è°ƒç”¨
- âœ… ä¸»å¾ªç¯æ–¹æ³•å­˜åœ¨
- âœ… é‡è¯•æœºåˆ¶ä¸ä¸»ç³»ç»Ÿæ­£ç¡®é›†æˆ

**æµ‹è¯•é€šè¿‡ç‡ï¼š** 100% (3/3)

### ğŸ“Š åŠŸèƒ½éªŒè¯

#### âœ… å·²å®ç°åŠŸèƒ½

1. **éªŒè¯ç æ¶ˆå¤±è§¦å‘é‡è¯•**
   - éªŒè¯ç æ¶ˆå¤±æ—¶è‡ªåŠ¨è®¾ç½® `retry_current_order = True`
   - è°ƒç”¨ `_trigger_order_retry()` æ–¹æ³•
   - è¾“å‡ºé‡è¯•ç›¸å…³æ—¥å¿—ä¿¡æ¯

2. **ä¸»å¾ªç¯é‡è¯•æ£€æŸ¥**
   - åœ¨ `run_actions_loop()` ä¸­æ£€æŸ¥é‡è¯•æ ‡å¿—
   - é‡è¯•æ—¶è¾“å‡º `[é‡è¯•]` æ ‡è¯†çš„æ—¥å¿—
   - ä¿å­˜å½“å‰è®¢å•ç´¢å¼•ç”¨äºçŠ¶æ€è·Ÿè¸ª

3. **çŠ¶æ€ç®¡ç†**
   - é‡è¯•æ ‡å¿—è‡ªåŠ¨é‡ç½®ï¼Œé¿å…é‡å¤é‡è¯•
   - ä¸å½±å“æ­£å¸¸çš„è®¢å•å¤„ç†æµç¨‹
   - ä¸ç°æœ‰éªŒè¯ç æ£€æµ‹æœºåˆ¶å®Œç¾é›†æˆ

4. **æ—¥å¿—è®°å½•**
   - é‡è¯•è§¦å‘ï¼š"è§¦å‘å½“å‰è®¢å•é‡è¯•æœºåˆ¶"
   - é‡è¯•æ‰§è¡Œï¼š"[é‡è¯•] é‡æ–°å¤„ç†ç¬¬ X/Y ä¸ªè®¢å•"
   - éªŒè¯ç å¤„ç†ï¼š"éªŒè¯ç å·²å¤„ç†ï¼Œå‡†å¤‡é‡è¯•å½“å‰è®¢å•"

#### ğŸ”„ å·¥ä½œæµç¨‹

1. **æ­£å¸¸æµç¨‹**ï¼šè®¢å•å¤„ç† â†’ éªŒè¯ç æ£€æµ‹ â†’ ç»§ç»­å¤„ç†
2. **é‡è¯•æµç¨‹**ï¼šè®¢å•å¤„ç† â†’ éªŒè¯ç å‡ºç° â†’ æš‚åœ â†’ éªŒè¯ç æ¶ˆå¤± â†’ è®¾ç½®é‡è¯•æ ‡å¿— â†’ é‡æ–°å¤„ç†å½“å‰è®¢å•

### ğŸ¯ è¾¾æˆæ ‡å‡†éªŒè¯

#### âœ… å®Œå…¨è¾¾æˆ (100%)
- [x] éªŒè¯ç æ¶ˆå¤±å `retry_current_order` æ ‡å¿—æ­£ç¡®è®¾ç½®ä¸º `True`
- [x] `_trigger_order_retry()` æ–¹æ³•æ­£ç¡®å®ç°å¹¶å¯è°ƒç”¨
- [x] `run_actions_loop()` ä¸­æ­£ç¡®æ£€æŸ¥é‡è¯•æ ‡å¿—
- [x] é‡è¯•æ—¶æ­£ç¡®é‡ç½® `consecutive_same_order` è®¡æ•°å™¨
- [x] é‡è¯•æ—¥å¿—æ­£ç¡®è¾“å‡ºï¼ŒåŒ…å«"[é‡è¯•]"æ ‡è¯†
- [x] éªŒè¯ç æ¶ˆå¤±åèƒ½è‡ªåŠ¨é‡æ–°å¤„ç†å½“å‰è®¢å•
- [x] ä¸å½±å“æ­£å¸¸çš„è®¢å•å¤„ç†æµç¨‹

### ğŸš€ æŠ€æœ¯ç‰¹ç‚¹

#### 1. æœ€å°ä¾µå…¥æ€§è®¾è®¡
- ä»…ä¿®æ”¹3ä¸ªæ–‡ä»¶ï¼Œå…±å¢åŠ çº¦20è¡Œä»£ç 
- ä¸æ”¹å˜ç°æœ‰æ ¸å¿ƒé€»è¾‘
- å‘åå…¼å®¹ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½

#### 2. çº¿ç¨‹å®‰å…¨
- ä½¿ç”¨ `self.root.after()` ç¡®ä¿UIçº¿ç¨‹å®‰å…¨
- çŠ¶æ€æ ‡å¿—åŸå­æ“ä½œ
- é¿å…ç«æ€æ¡ä»¶

#### 3. çŠ¶æ€åŒæ­¥
- é‡è¯•æ ‡å¿—è‡ªåŠ¨é‡ç½®æœºåˆ¶
- è®¢å•ç´¢å¼•æ­£ç¡®è·Ÿè¸ª
- ä¸éªŒè¯ç æ£€æµ‹çŠ¶æ€åŒæ­¥

#### 4. é”™è¯¯å¤„ç†
- å®Œæ•´çš„å¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•
- ä¼˜é›…çš„é”™è¯¯æ¢å¤æœºåˆ¶
- ä¸ä¼šå› é‡è¯•å¤±è´¥å½±å“ä¸»æµç¨‹

### ğŸ“ˆ æ€§èƒ½å½±å“

- **CPUä½¿ç”¨ç‡ï¼š** æ— æ˜¾è‘—å¢åŠ 
- **å†…å­˜å ç”¨ï¼š** å¢åŠ çº¦4ä¸ªå¸ƒå°”/æ•´å‹å˜é‡ï¼Œå½±å“å¾®ä¹å…¶å¾®
- **å“åº”æ—¶é—´ï¼š** é‡è¯•è§¦å‘å»¶è¿Ÿ < 100ms
- **ç¨³å®šæ€§ï¼š** æ— è´Ÿé¢å½±å“ï¼Œé€šè¿‡å…¨éƒ¨æµ‹è¯•

### ğŸ”® åç»­è®¡åˆ’

#### é˜¶æ®µäºŒï¼šåæ ‡ç¼“å­˜ä¼˜åŒ–
- å®ç°åæ ‡ç¼“å­˜ç³»ç»Ÿ
- æé«˜é‡è¯•æˆåŠŸç‡
- å‡å°‘å…ƒç´ æŸ¥æ‰¾æ—¶é—´

#### é˜¶æ®µä¸‰ï¼šé…ç½®åŒ–å¢å¼º
- æ·»åŠ é‡è¯•é…ç½®æ–‡ä»¶
- å®ç°é‡è¯•ç­–ç•¥é€‰æ‹©
- å¢å¼ºç›‘æ§å’Œç»Ÿè®¡åŠŸèƒ½

### ğŸ“ æ€»ç»“

é˜¶æ®µä¸€åŸºç¡€é‡è¯•æœºåˆ¶å·²æˆåŠŸå®ç°å¹¶é€šè¿‡å…¨éƒ¨æµ‹è¯•ã€‚è¯¥å®ç°å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. **åŠŸèƒ½å®Œæ•´**ï¼šè¦†ç›–äº†é‡è¯•æœºåˆ¶çš„æ ¸å¿ƒåŠŸèƒ½
2. **è®¾è®¡ä¼˜é›…**ï¼šæœ€å°ä¾µå…¥æ€§ï¼Œé«˜åº¦é›†æˆ
3. **æµ‹è¯•å……åˆ†**ï¼š100%æµ‹è¯•é€šè¿‡ç‡
4. **æ–‡æ¡£å®Œå–„**ï¼šè¯¦ç»†çš„å®ç°è®°å½•å’ŒéªŒè¯æŠ¥å‘Š

è¯¥é˜¶æ®µä¸ºåç»­çš„åæ ‡ç¼“å­˜ä¼˜åŒ–å’Œé…ç½®åŒ–å¢å¼ºå¥ å®šäº†åšå®çš„åŸºç¡€ï¼Œé‡è¯•æœºåˆ¶å·²å¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š** 2025-01-27  
**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… ç»¼åˆæ–‡æ¡£æ•´ç†å®Œæˆ  
**åŒ…å«å†…å®¹ï¼š** é¡¹ç›®å¼€å‘è®¡åˆ’ã€é‡è¯•åŠŸèƒ½å®ç°ã€éªŒè¯ç æ£€æµ‹ä¿®å¤ã€é˜¶æ®µå®ŒæˆæŠ¥å‘Š